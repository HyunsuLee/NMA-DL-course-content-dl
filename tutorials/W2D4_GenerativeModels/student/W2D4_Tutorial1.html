
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 1: Variational Autoencoders (VAEs) — Neuromatch Academy: Deep Learning</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-dl-logo-square-4xp.jpeg" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D4_Tutorial2.html" rel="next" title="Tutorial 2: Introduction to GANs"/>
<link href="../chapter_title.html" rel="prev" title="Generative Models"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/nma-dl-logo-square-4xp.jpeg"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Deep Learning</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General schedule
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/shared_calendars.html">
     Shared calendars
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/timezone_widget.html">
     Timezone widget
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using Discord
    </a>
</li>
</ul>
</input></li>
</ul>
<p class="caption">
<span class="caption-text">
  Basics Module
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_BasicsAndPytorch/chapter_title.html">
   Basics And Pytorch (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_BasicsAndPytorch/student/W1D1_Tutorial1.html">
     Tutorial 1: PyTorch
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_LinearDeepLearning/chapter_title.html">
   Linear Deep Learning (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial1.html">
     Tutorial 1: Gradient Descent and AutoGrad
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial2.html">
     Tutorial 2: Learning Hyperparameters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_LinearDeepLearning/student/W1D2_Tutorial3.html">
     Tutorial 3: Deep linear neural networks
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/chapter_title.html">
   Multi Layer Perceptrons (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial1.html">
     Tutorial 1: Biological vs. Artificial Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_MultiLayerPerceptrons/student/W1D3_Tutorial2.html">
     Tutorial 2: Deep MLPs
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Fine Tuning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_Optimization/chapter_title.html">
   Optimization (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_Optimization/student/W1D5_Tutorial1.html">
     Tutorial 1: Optimization techniques
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_Regularization/chapter_title.html">
   Regularization (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial1.html">
     Tutorial 1: Regularization techniques part 1
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_Regularization/student/W2D1_Tutorial2.html">
     Tutorial 2: Regularization techniques part 2
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Convolutional Neural Networks
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/chapter_title.html">
   Convnets And Dl Thinking (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial1.html">
     Tutorial 1: Introduction to CNNs
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_ConvnetsAndDlThinking/student/W2D2_Tutorial2.html">
     Tutorial 2: Deep Learning Thinking 1: Cost Functions
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_ModernConvnets/chapter_title.html">
   Modern Convnets (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial1.html">
     Tutorial 1: Learn how to use modern convnets
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_ModernConvnets/student/W2D3_Tutorial2.html">
     (Bonus) Tutorial 2: Facial recognition using modern convnets
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Generative Models (W2D4)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 1: Variational Autoencoders (VAEs)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial2.html">
     Tutorial 2: Introduction to GANs
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial3.html">
     Tutorial 3: Conditional GANs and Implications of GAN Technology
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial4.html">
     (Bonus) Tutorial 4: Deploying Neural Networks on the Web
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Natural Language Processing
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D5_TimeSeriesAndNaturalLanguageProcessing/chapter_title.html">
   Time Series And Natural Language Processing (W2D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_TimeSeriesAndNaturalLanguageProcessing/student/W2D5_Tutorial1.html">
     Tutorial 1: Introduction to processing time series
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_TimeSeriesAndNaturalLanguageProcessing/student/W2D5_Tutorial2.html">
     Tutorial 2: Time series for Language
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_AttentionAndTransformers/chapter_title.html">
   Attention And Transformers (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_AttentionAndTransformers/student/W3D1_Tutorial1.html">
     Tutorial 1: Learn how to work with Transformers
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_DlThinking2/chapter_title.html">
   Dl Thinking2 (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_DlThinking2/student/W3D2_Tutorial1.html">
     Tutorial 1: Deep Learning Thinking 2: Architectures and Multimodal DL thinking
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Reinforcement Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/chapter_title.html">
   Unsupervised And Self Supervised Learning (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_UnsupervisedAndSelfSupervisedLearning/student/W3D3_Tutorial1.html">
     Tutorial 1: Un/Self-supervised learning methods
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/chapter_title.html">
   Basic Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: Model-Based Reinforcement Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_BasicReinforcementLearning/student/W3D4_Tutorial5.html">
     (Bonus) Tutorial 5: Function approximation
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_ReinforcementLearningForGames/chapter_title.html">
   Reinforcement Learning For Games (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_ReinforcementLearningForGames/student/W3D5_Tutorial1.html">
     Tutorial 1: Learn to play games with RL
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction to projects
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/modelingsteps/intro.html">
   Modeling Step-by-Step Guide
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_1through2_DL.html">
     Modeling Steps 1 - 2
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_3through4_DL.html">
     Modeling Steps 3 - 4
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_5through6_DL.html">
     Modeling Steps 5 - 6
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_7through9_DL.html">
     Modeling Steps 7 - 9
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/ModelingSteps_10_DL.html">
     Modeling Steps 10
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionDataProjectDL.html">
     Example Data Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/TrainIllusionModelingProjectDL.html">
     Example Model Project: the Train Illusion
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/modelingsteps/Example_Deep_Learning_Project.html">
     Example Deep Learning Project
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/projects_overview.html">
   Project Templates
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/ComputerVision/README.html">
     Computer Vision
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/slides.html">
       Slides
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/ideas_and_datasets.html">
       Ideas
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/em_synapses.html">
       Knowledge Extraction from a Convolutional Neural Network
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/spectrogram_analysis.html">
       Music classification and generation with spectrograms
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/screws.html">
       Something Screwy - image recognition, detection, and classification of screws
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/image_alignment.html">
       Image Alignment
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/data_augmentation.html">
       Data Augmentation in image classification models
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ComputerVision/transfer_learning.html">
       Transfer Learning
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/ReinforcementLearning/README.html">
     Reinforcement Learning
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
<label for="toctree-checkbox-21">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ReinforcementLearning/slides.html">
       Slides
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ReinforcementLearning/ideas_and_datasets.html">
       Ideas
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ReinforcementLearning/robolympics.html">
       NMA Robolympics: Controlling robots using reinforcement learning
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ReinforcementLearning/lunar_lander.html">
       Performance Analysis of DQN Algorithm on the Lunar Lander task
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/ReinforcementLearning/human_rl.html">
       Using RL to Model Cognitive Tasks
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/NaturalLanguageProcessing/README.html">
     Natural Language Processing
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
<label for="toctree-checkbox-22">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/NaturalLanguageProcessing/slides.html">
       Slides
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/NaturalLanguageProcessing/ideas_and_datasets.html">
       Ideas
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/NaturalLanguageProcessing/sentiment_analysis.html">
       Twitter Sentiment Analysis
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/NaturalLanguageProcessing/machine_translation.html">
       Machine Translation
      </a>
</li>
</ul>
</li>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../../projects/Neuroscience/README.html">
     Neuroscience
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
<label for="toctree-checkbox-23">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/slides.html">
       Slides
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/ideas_and_datasets.html">
       Ideas
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/pose_estimation.html">
       Animal Pose Estimation
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/cellular_segmentation.html">
       Segmentation and Denoising
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/algonauts_videos.html">
       Load algonauts videos
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/blurry_vision.html">
       Vision with Lost Glasses: Modelling how the brain deals with noisy input
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/finetuning_fmri.html">
       Moving beyond Labels: Finetuning CNNs on BOLD response
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../../projects/Neuroscience/neuro_seq_to_seq.html">
       Focus on what matters: inferring low-dimensional dynamics from neural recordings
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/datasets_and_models.html">
   Models and Data sets
  </a>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/course-content-dl" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/NeuromatchAcademy/course-content-dl/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D4_GenerativeModels/student/W2D4_Tutorial1.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D4_GenerativeModels/student/W2D4_Tutorial1.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Variational Autoencoders (VAEs)
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-wordnet-dataset">
     Download
     <code class="docutils literal notranslate">
<span class="pre">
       wordnet
      </span>
</code>
     dataset
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-generative-models">
   Section 1: Generative models
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-generative-modeling">
     Video 1: Generative Modeling
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-generating-images-from-biggan">
     Section 1.1: Generating Images from BigGAN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-biggan-generator">
       Interactive Demo 1.1: BigGAN Generator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-1-generated-images">
       Think! 1.1: Generated images
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#student-response">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-interpolating-images-with-biggan">
     Section 1.2: Interpolating Images with BigGAN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-biggan-interpolation">
       Interactive Demo 1.2: BigGAN Interpolation
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-2-interpolating-samples-from-the-same-category">
       Think! 1.2: Interpolating samples from the same category
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-latent-variable-models">
   Section 2: Latent Variable Models
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-latent-variable-models">
     Video 2: Latent Variable Models
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-ppca-bonus">
     Coding Exercise 2: pPCA (Bonus)
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-autoencoders">
   Section 3: Autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-autoenconders">
     Video 3: Autoenconders
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#select-a-dataset">
       Select a dataset
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-conceptual-introduction-to-autoencoders">
     Section 3.1: Conceptual introduction to AutoEncoders
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-1-linear-autoencoder-architecture">
       Coding Exercise 3.1: Linear AutoEncoder Architecture
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#comparison-to-pca">
       Comparison to PCA
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-pca-vs-linear-autoenconder">
       Think! 3.1: PCA vs. Linear autoenconder
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-building-a-nonlinear-convolutional-autoencoder">
     Section 3.2: Building a nonlinear convolutional autoencoder
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-2-fill-in-code-for-the-convautoencoder-module">
       Coding Exercise 3.2: Fill in code for the
       <code class="docutils literal notranslate">
<span class="pre">
         ConvAutoEncoder
        </span>
</code>
       module
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-variational-auto-encoders-vaes">
   Section 4: Variational Auto-Encoders (VAEs)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-variational-autoencoders">
     Video 4: Variational Autoencoders
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-1-components-of-a-vae">
     Section 4.1: Components of a VAE
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-2-generating-novel-images-from-the-decoder">
     Section 4.2: Generating novel images from the decoder
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-2-generating-images">
       Coding Exercise 4.2: Generating images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-4-2-autoencoders-vs-variational-autoencoders">
       Think! 4.2: AutoEncoders vs. Variational AutoEncoders
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-state-of-the-art-vaes-and-wrap-up">
   Section 5: State of the art VAEs and Wrap-up
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-state-of-the-art-vaes">
     Video 5: State-Of-The-Art VAEs
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#airtable-submission-link">
     Airtable Submission Link
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 1: Variational Autoencoders (VAEs)</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 1: Variational Autoencoders (VAEs)
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#install-dependencies">
     Install dependencies
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting functions
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-random-seed">
     Set random seed
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#set-device-gpu-or-cpu-execute-set-device">
     Set device (GPU or CPU). Execute
     <code class="docutils literal notranslate">
<span class="pre">
       set_device()
      </span>
</code>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-wordnet-dataset">
     Download
     <code class="docutils literal notranslate">
<span class="pre">
       wordnet
      </span>
</code>
     dataset
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-generative-models">
   Section 1: Generative models
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-generative-modeling">
     Video 1: Generative Modeling
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-generating-images-from-biggan">
     Section 1.1: Generating Images from BigGAN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-1-biggan-generator">
       Interactive Demo 1.1: BigGAN Generator
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-1-generated-images">
       Think! 1.1: Generated images
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#student-response">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-interpolating-images-with-biggan">
     Section 1.2: Interpolating Images with BigGAN
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-1-2-biggan-interpolation">
       Interactive Demo 1.2: BigGAN Interpolation
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-1-2-interpolating-samples-from-the-same-category">
       Think! 1.2: Interpolating samples from the same category
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-latent-variable-models">
   Section 2: Latent Variable Models
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-latent-variable-models">
     Video 2: Latent Variable Models
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-2-ppca-bonus">
     Coding Exercise 2: pPCA (Bonus)
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-autoencoders">
   Section 3: Autoencoders
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-3-autoenconders">
     Video 3: Autoenconders
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#select-a-dataset">
       Select a dataset
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-conceptual-introduction-to-autoencoders">
     Section 3.1: Conceptual introduction to AutoEncoders
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-1-linear-autoencoder-architecture">
       Coding Exercise 3.1: Linear AutoEncoder Architecture
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#comparison-to-pca">
       Comparison to PCA
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-3-1-pca-vs-linear-autoenconder">
       Think! 3.1: PCA vs. Linear autoenconder
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Student Response
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-building-a-nonlinear-convolutional-autoencoder">
     Section 3.2: Building a nonlinear convolutional autoencoder
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-3-2-fill-in-code-for-the-convautoencoder-module">
       Coding Exercise 3.2: Fill in code for the
       <code class="docutils literal notranslate">
<span class="pre">
         ConvAutoEncoder
        </span>
</code>
       module
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-variational-auto-encoders-vaes">
   Section 4: Variational Auto-Encoders (VAEs)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-4-variational-autoencoders">
     Video 4: Variational Autoencoders
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-1-components-of-a-vae">
     Section 4.1: Components of a VAE
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-4-2-generating-novel-images-from-the-decoder">
     Section 4.2: Generating novel images from the decoder
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#coding-exercise-4-2-generating-images">
       Coding Exercise 4.2: Generating images
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#think-4-2-autoencoders-vs-variational-autoencoders">
       Think! 4.2: AutoEncoders vs. Variational AutoEncoders
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-5-state-of-the-art-vaes-and-wrap-up">
   Section 5: State of the art VAEs and Wrap-up
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-5-state-of-the-art-vaes">
     Video 5: State-Of-The-Art VAEs
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#airtable-submission-link">
     Airtable Submission Link
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content-dl/blob/main/tutorials/W2D4_GenerativeModels/student/W2D4_Tutorial1.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a>   <a href="https://kaggle.com/kernels/welcome?src=https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/student/W2D4_Tutorial1.ipynb" target="_blank"><img alt="Open in Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg"/></a></p>
<div class="section" id="tutorial-1-variational-autoencoders-vaes">
<h1>Tutorial 1: Variational Autoencoders (VAEs)<a class="headerlink" href="#tutorial-1-variational-autoencoders-vaes" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 4: Generative Models</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Saeed Salehi, Spiros Chavlis, Vikash Gilja</p>
<p><strong>Content reviewers:</strong> Diptodip Deb, Kelson Shilling-Scrivo</p>
<p><strong>Content editor:</strong> Charles J Edelson, Spiros Chavlis</p>
<p><strong>Production editors:</strong> Saeed Salehi, Gagana B, Spiros Chavlis</p>
<br/>
<p><em>Inspired from UPenn course</em>:
<strong>Instructor:</strong> Konrad Kording, <strong>Original Content creators:</strong> Richard Lange, Arash Ash</p>
<p><strong>Our 2022 Sponsors, including Presenting Sponsor Facebook Reality Labs</strong></p>
<p align="center"><img src="https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True"/></p></div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In the first tutorial of the <em>Generative Models</em> day, we are going to</p>
<ul class="simple">
<li><p>Think about unsupervised learning / Generative Models and get a bird’s eye view of why it is useful</p></li>
<li><p>Build intuition about latent variables</p></li>
<li><p>See the connection between AutoEncoders and PCA</p></li>
<li><p>Start thinking about neural networks as generative models by contrasting AutoEncoders and Variational AutoEncoders</p></li>
</ul>
<div class="section" id="tutorial-slides">
<h2>Tutorial slides<a class="headerlink" href="#tutorial-slides" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
<iframe allowfullscreen="" frameborder="0" height="480" src="https://mfr.ca-1.osf.io/render?url=https://osf.io/rd7ng/?direct%26mode=render%26action=download%26mode=render" width="854"></iframe>
</div></div>
</div>
<p>These are the slides for all videos in this tutorial. If you want to locally download the slides, click <a class="reference external" href="https://osf.io/rd7ng/download">here</a>.</p>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install-dependencies">
<h2>Install dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Install dependencies</span>
<span class="c1"># @markdown #### Please ignore *errors* and/or *warnings* during installation.</span>
<span class="c1"># @markdown ##### Install `Huggingface BigGAN` library</span>
<span class="o">!</span>pip install pytorch-pretrained-biggan --quiet
<span class="o">!</span>pip install Pillow libsixel-python --quiet

<span class="o">!</span>pip install git+https://github.com/NeuromatchAcademy/evaltools --quiet
<span class="kn">from</span> <span class="nn">evaltools.airtable</span> <span class="kn">import</span> <span class="n">AirtableForm</span>

<span class="c1"># Generate airtable form</span>
<span class="n">atform</span> <span class="o">=</span> <span class="n">AirtableForm</span><span class="p">(</span><span class="s1">'appn7VdPRseSoMXEG'</span><span class="p">,</span><span class="s1">'W2D5_T1'</span><span class="p">,</span><span class="s1">'https://portal.neuromatchacademy.org/api/redirect/to/9c55f6cb-cdf9-4429-ac1c-ec44fe64c303'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>

<span class="kn">from</span> <span class="nn">pytorch_pretrained_biggan</span> <span class="kn">import</span> <span class="n">one_hot_from_names</span>

<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span><span class="p">,</span> <span class="n">trange</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">VBox</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive_output</span><span class="p">,</span> <span class="n">Dropdown</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/content-creation/main/nma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">image_moments</span><span class="p">(</span><span class="n">image_batches</span><span class="p">,</span> <span class="n">n_batches</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Compute mean and covariance of all pixels</span>
<span class="sd">  from batches of images</span>

<span class="sd">  Args:</span>
<span class="sd">    Image_batches: tuple</span>
<span class="sd">      Image batches</span>
<span class="sd">    n_batches: int</span>
<span class="sd">      Number of Batch size</span>

<span class="sd">  Returns:</span>
<span class="sd">    m1: float</span>
<span class="sd">      Mean of all pixels</span>
<span class="sd">    cov: float</span>
<span class="sd">      Covariance of all pixels</span>
<span class="sd">  """</span>
  <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((),</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((),</span> <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">image_batches</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">n_batches</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">desc</span><span class="o">=</span><span class="s1">'Computing pixel mean and covariance...'</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">+</span> <span class="n">im</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">+</span> <span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">im</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="n">b</span>
  <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">m1</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">m2</span><span class="o">/</span><span class="n">n</span>
  <span class="n">cov</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">-</span> <span class="n">m1</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m1</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">m1</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span> <span class="n">cov</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Function to interpolate between images.</span>
<span class="sd">  It does this by linearly interpolating between the</span>
<span class="sd">  probability of each category you select and linearly</span>
<span class="sd">  interpolating between the latent vector values.</span>

<span class="sd">  Args:</span>
<span class="sd">    A: list</span>
<span class="sd">      List of categories</span>
<span class="sd">    B: list</span>
<span class="sd">      List of categories</span>
<span class="sd">    num_interps: int</span>
<span class="sd">      Quantity of pixel grids</span>

<span class="sd">  Returns:</span>
<span class="sd">    Interpolated np.ndarray</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">B</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'A and B must have the same shape to interpolate.'</span><span class="p">)</span>
  <span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">A</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">B</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">kl_q_p</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Given [b,n,k] samples of z drawn</span>
<span class="sd">  from q, compute estimate of KL(q||p).</span>
<span class="sd">  phi must be size [b,k+1]</span>
<span class="sd">  This uses mu_p = 0 and sigma_p = 1,</span>
<span class="sd">  which simplifies the log(p(zs)) term to</span>
<span class="sd">  just -1/2*(zs**2)</span>

<span class="sd">  Args:</span>
<span class="sd">    zs: list</span>
<span class="sd">      Samples</span>
<span class="sd">    phi: list</span>
<span class="sd">      Relative entropy</span>

<span class="sd">  Returns:</span>
<span class="sd">    Size of log_q and log_p is [b,n,k].</span>
<span class="sd">    Sum along [k] but mean along [b,n]</span>
<span class="sd">  """</span>
  <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
  <span class="n">mu_q</span><span class="p">,</span> <span class="n">log_sig_q</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">phi</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">log_p</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">zs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">log_q</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">zs</span> <span class="o">-</span> <span class="n">mu_q</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">log_sig_q</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">log_sig_q</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># Size of log_q and log_p is [b,n,k].</span>
  <span class="c1"># Sum along [k] but mean along [b,n]</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">log_q</span> <span class="o">-</span> <span class="n">log_p</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">log_p_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_xs</span><span class="p">,</span> <span class="n">sig_x</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Given [batch, ...] input x and</span>
<span class="sd">  [batch, n, ...] reconstructions, compute</span>
<span class="sd">  pixel-wise log Gaussian probability</span>
<span class="sd">  Sum over pixel dimensions, but mean over batch</span>
<span class="sd">  and samples.</span>

<span class="sd">  Args:</span>
<span class="sd">    x: np.ndarray</span>
<span class="sd">      Input Data</span>
<span class="sd">    mu_xs: np.ndarray</span>
<span class="sd">      Log of mean of samples</span>
<span class="sd">    sig_x: np.ndarray</span>
<span class="sd">      Log of standard deviation</span>

<span class="sd">  Returns:</span>
<span class="sd">    Mean over batch and samples.</span>
<span class="sd">  """</span>
  <span class="n">b</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">mu_xs</span><span class="o">.</span><span class="n">size</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
  <span class="c1"># Flatten out pixels and add a singleton</span>
  <span class="c1"># dimension [1] so that x will be</span>
  <span class="c1"># implicitly expanded when combined with mu_xs</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
  <span class="n">squared_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu_xs</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sig_x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

  <span class="c1"># Size of squared_error is [b,n,p]. log prob is</span>
  <span class="c1"># by definition sum over [p].</span>
  <span class="c1"># Expected value requires mean over [n].</span>
  <span class="c1"># Handling different size batches</span>
  <span class="c1"># requires mean over [b].</span>
  <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">squared_error</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">sig_x</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">pca_encoder_decoder</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Compute encoder and decoder matrices</span>
<span class="sd">  for PCA dimensionality reduction</span>

<span class="sd">  Args:</span>
<span class="sd">    mu: np.ndarray</span>
<span class="sd">      Mean</span>
<span class="sd">    cov: float</span>
<span class="sd">      Covariance</span>
<span class="sd">    k: int</span>
<span class="sd">      Dimensionality</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">svd_lowrank</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
  <span class="n">W_encode</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="n">W_decode</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">pca_encode</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Encoder: Subtract mean image and</span>
<span class="sd">    project onto top K eigenvectors of</span>
<span class="sd">    the data covariance</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input data</span>

<span class="sd">    Returns:</span>
<span class="sd">      PCA Encoding</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">mu</span><span class="o">.</span><span class="n">numel</span><span class="p">())</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">@</span> <span class="n">W_encode</span>

  <span class="k">def</span> <span class="nf">pca_decode</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Decoder: un-project then add back in the mean</span>

<span class="sd">    Args:</span>
<span class="sd">      h: torch.tensor</span>
<span class="sd">        Hidden layer data</span>

<span class="sd">    Returns:</span>
<span class="sd">      PCA Decoding</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">h</span> <span class="o">@</span> <span class="n">W_decode</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">mu</span>

  <span class="k">return</span> <span class="n">pca_encode</span><span class="p">,</span> <span class="n">pca_decode</span>


<span class="k">def</span> <span class="nf">cout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Unnecessarily complicated but complete way to</span>
<span class="sd">  calculate the output depth, height</span>
<span class="sd">  and width size for a Conv2D layer</span>

<span class="sd">  Args:</span>
<span class="sd">    x: tuple</span>
<span class="sd">      Input size (depth, height, width)</span>
<span class="sd">    layer: nn.Conv2d</span>
<span class="sd">      The Conv2D layer</span>

<span class="sd">  Returns:</span>
<span class="sd">    Tuple of out-depth/out-height and out-width</span>
<span class="sd">    Output shape as given in [Ref]</span>
<span class="sd">    Ref:</span>
<span class="sd">    https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html</span>
<span class="sd">  """</span>
  <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">)</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">padding</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">padding</span><span class="p">,)</span>
  <span class="n">k</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">kernel_size</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">,)</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">dilation</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">dilation</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">dilation</span><span class="p">,)</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">stride</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">stride</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">stride</span><span class="p">,)</span>
  <span class="n">in_depth</span><span class="p">,</span> <span class="n">in_height</span><span class="p">,</span> <span class="n">in_width</span> <span class="o">=</span> <span class="n">x</span>
  <span class="n">out_depth</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">out_channels</span>
  <span class="n">out_height</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">in_height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">out_width</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">in_width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">out_depth</span><span class="p">,</span> <span class="n">out_height</span><span class="p">,</span> <span class="n">out_width</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting functions</span>

<span class="k">def</span> <span class="nf">plot_gen_samples_ppca</span><span class="p">(</span><span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span><span class="p">,</span> <span class="n">therm_data_sim</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Plotting generated samples</span>

<span class="sd">  Args:</span>
<span class="sd">    therm1: list</span>
<span class="sd">      Thermometer 1</span>
<span class="sd">    them2: list</span>
<span class="sd">      Thermometer 2</span>
<span class="sd">    therm_data_sim: list</span>
<span class="sd">      Generated (simulate, draw) `n_samples` from pPCA model</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'c'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'training data'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">therm_data_sim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">therm_data_sim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'.'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'m'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'"generated" data'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Thermometer 1 ($^\circ$C)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Thermometer 2 ($^\circ$C)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_linear_ae</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Plotting linear autoencoder</span>

<span class="sd">  Args:</span>
<span class="sd">    lin_losses: list</span>
<span class="sd">      Log of linear autoencoder MSE losses</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Training batch'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'MSE Loss'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_conv_ae</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">,</span> <span class="n">conv_losses</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Plotting convolutional autoencoder</span>

<span class="sd">  Args:</span>
<span class="sd">    lin_losses: list</span>
<span class="sd">      Log of linear autoencoder MSE losses</span>
<span class="sd">    conv_losses: list</span>
<span class="sd">      Log of convolutional model MSe losses</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">conv_losses</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'Lin AE'</span><span class="p">,</span> <span class="s1">'Conv AE'</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Training batch'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'MSE Loss'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>
            <span class="mi">2</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">conv_losses</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span>
                  <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">lin_losses</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">())])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_images</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plt_title</span><span class="o">=</span><span class="s1">''</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Helper function to plot images</span>

<span class="sd">  Args:</span>
<span class="sd">    images: torch.tensor</span>
<span class="sd">      Images</span>
<span class="sd">    h: int</span>
<span class="sd">      Image height</span>
<span class="sd">    w: int</span>
<span class="sd">      Image width</span>
<span class="sd">    plt_title: string</span>
<span class="sd">      Plot title</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">plt_title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="n">w</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_phi</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Contour plot of relative entropy across samples</span>

<span class="sd">  Args:</span>
<span class="sd">    phi: list</span>
<span class="sd">      Log of relative entropu changes</span>
<span class="sd">    num: int</span>
<span class="sd">      Number of interations</span>
<span class="sd">  """</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">zs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'.'</span><span class="p">)</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.28318</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="c1"># Draw 2-sigma contours</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">'If rsample() is correct, then most but not all points should lie in the circles'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_torch_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Helper function to plot torch image</span>

<span class="sd">  Args:</span>
<span class="sd">    image: torch.tensor</span>
<span class="sd">      Image</span>
<span class="sd">    ax: plt object</span>
<span class="sd">      If None, plt.gca()</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
  <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">c</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="s1">'gray'</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="kc">None</span>

  <span class="c1"># Torch images have shape (channels, height, width)</span>
  <span class="c1"># but matplotlib expects</span>
  <span class="c1"># (height, width, channels) or just</span>
  <span class="c1"># (height,width) when grayscale</span>
  <span class="n">im_plt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_plt</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'right'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">'top'</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-random-seed">
<h2>Set random seed<a class="headerlink" href="#set-random-seed" title="Permalink to this headline">¶</a></h2>
<p>Executing <code class="docutils literal notranslate"><span class="pre">set_seed(seed=seed)</span></code> you are setting the seed</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set random seed</span>

<span class="c1"># @markdown Executing `set_seed(seed=seed)` you are setting the seed</span>

<span class="c1"># For DL its critical to set the random seed so that students can have a</span>
<span class="c1"># baseline to compare their results to expected results.</span>
<span class="c1"># Read more here: https://pytorch.org/docs/stable/notes/randomness.html</span>

<span class="c1"># Call `set_seed` function in the exercises to ensure reproducibility.</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed_torch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Function that controls randomness. NumPy and random modules must be imported.</span>

<span class="sd">  Args:</span>
<span class="sd">    seed : Integer</span>
<span class="sd">      A non-negative integer that defines the random state. Default is `None`.</span>
<span class="sd">    seed_torch : Boolean</span>
<span class="sd">      If `True` sets the random seed for pytorch tensors, so pytorch module</span>
<span class="sd">      must be imported. Default is `True`.</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing.</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">seed_torch</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Random seed </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s1"> has been set.'</span><span class="p">)</span>


<span class="c1"># In case that `DataLoader` is used</span>
<span class="k">def</span> <span class="nf">seed_worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  DataLoader will reseed workers following randomness in</span>
<span class="sd">  multi-process data loading algorithm.</span>

<span class="sd">  Args:</span>
<span class="sd">    worker_id: integer</span>
<span class="sd">      ID of subprocess to seed. 0 means that</span>
<span class="sd">      the data will be loaded in the main process</span>
<span class="sd">      Refer: https://pytorch.org/docs/stable/data.html#data-loading-randomness for more details</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">worker_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">initial_seed</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
  <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">worker_seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-device-gpu-or-cpu-execute-set-device">
<h2>Set device (GPU or CPU). Execute <code class="docutils literal notranslate"><span class="pre">set_device()</span></code><a class="headerlink" href="#set-device-gpu-or-cpu-execute-set-device" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Set device (GPU or CPU). Execute `set_device()`</span>
<span class="c1"># especially if torch modules used.</span>

<span class="c1"># Inform the user if the notebook uses GPU or CPU.</span>

<span class="k">def</span> <span class="nf">set_device</span><span class="p">():</span>
  <span class="sd">"""</span>
<span class="sd">  Set the device. CUDA if available, CPU otherwise</span>

<span class="sd">  Args:</span>
<span class="sd">    None</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">device</span> <span class="o">=</span> <span class="s2">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">"cpu"</span>
  <span class="k">if</span> <span class="n">device</span> <span class="o">!=</span> <span class="s2">"cuda"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"WARNING: For this notebook to perform best, "</span>
        <span class="s2">"if possible, in the menu under `Runtime` -&gt; "</span>
        <span class="s2">"`Change runtime type.`  select `GPU` "</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"GPU is enabled in this notebook."</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">device</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">2021</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">set_device</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
WARNING: For this notebook to perform best, if possible, in the menu under `Runtime` -&gt; `Change runtime type.`  select `GPU` 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="download-wordnet-dataset">
<h2>Download <code class="docutils literal notranslate"><span class="pre">wordnet</span></code> dataset<a class="headerlink" href="#download-wordnet-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download `wordnet` dataset</span>

<span class="sd">"""</span>
<span class="sd">NLTK Download:</span>

<span class="sd">import nltk</span>
<span class="sd">nltk.download('wordnet')</span>
<span class="sd">"""</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">zipfile</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'NLTK_DATA'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'nltk_data/'</span>

<span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'wordnet.zip'</span><span class="p">,</span> <span class="s1">'omw-1.4.zip'</span><span class="p">]</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://osf.io/ekjxy/download'</span><span class="p">,</span> <span class="s1">'https://osf.io/kuwep/download'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">fname</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fnames</span><span class="p">,</span> <span class="n">urls</span><span class="p">):</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
    <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">'nltk_data/corpora'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-generative-models">
<h1>Section 1: Generative models<a class="headerlink" href="#section-1-generative-models" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~15mins</em></p>
<p><strong>Please</strong> run the cell after the video to download BigGAN (a generative model) and a few standard image datasets while the video plays.</p>
<div class="section" id="video-1-generative-modeling">
<h2>Video 1: Generative Modeling<a class="headerlink" href="#video-1-generative-modeling" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c31c1fbd94424476890e883799f2d1d3"}
</script></div>
</div>
<p>Download BigGAN (a generative model) and a few standard image datasets</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Download BigGAN (a generative model) and a few standard image datasets</span>

<span class="c1">## Initially was downloaded directly</span>
<span class="c1"># biggan_model = BigGAN.from_pretrained('biggan-deep-256')</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://osf.io/3yvhw/download"</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s2">"biggan_deep_256"</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
  <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">biggan_model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-1-generating-images-from-biggan">
<h2>Section 1.1: Generating Images from BigGAN<a class="headerlink" href="#section-1-1-generating-images-from-biggan" title="Permalink to this headline">¶</a></h2>
<p>To demonstrate the power of generative models, we are giving you a sneak peek of a fully trained generative model called BigGAN. You’ll see it again (with more background under your belt) later today. For now, let’s just focus on BigGAN as a generative model. Specifically, BigGAN is a class conditional generative model for <span class="math notranslate nohighlight">\(128 \times 128\)</span> images. The classes are based on categorical labels that describe the images and images are generated based upon a vector (<span class="math notranslate nohighlight">\(z\)</span> from the video lecture) and the probability that the image comes from a specific discrete category.</p>
<p>For now, don’t worry about the specifics of the model other than the fact that it generates images based on the vector and the category label.</p>
<p>To explore the space of generated images, we’ve provided you with a widget that allows you to select a category label and to alter the value of the vector. The vector is a 128-D, which may seem high dimensional, but is much lower-dimensional than a <span class="math notranslate nohighlight">\(128 \times 128\)</span> image! To simplify usability the widget limits the magnitude of the vector and constrains all entries to be equal (so you are only exploring a subset of the possible images that can be generated).</p>
<div class="section" id="interactive-demo-1-1-biggan-generator">
<h3>Interactive Demo 1.1: BigGAN Generator<a class="headerlink" href="#interactive-demo-1-1-biggan-generator" title="Permalink to this headline">¶</a></h3>
<p>BigGAN Image Generator (the updates may take a few seconds)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown BigGAN Image Generator (the updates may take a few seconds)</span>

<span class="c1"># category = 'German shepherd' # @param ['tench', 'magpie', 'jellyfish', 'German shepherd', 'bee', 'acoustic guitar', 'coffee mug', 'minibus', 'monitor']</span>
<span class="c1"># z_magnitude = -16 # @param {type:"slider", min:-50, max:50, step:1}</span>

<span class="k">def</span> <span class="nf">sample_from_biggan</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">z_magnitude</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Sample from BigGAN Image Generator</span>

<span class="sd">  Args:</span>
<span class="sd">    category: string</span>
<span class="sd">      Category</span>
<span class="sd">    z_magnitude: int</span>
<span class="sd">      Magnitude of variation vector</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">unit_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">z_magnitude</span> <span class="o">*</span> <span class="n">unit_vector</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">one_hot_from_names</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

  <span class="c1"># Move to GPU</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">set_device</span><span class="p">())</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">set_device</span><span class="p">())</span>
  <span class="n">biggan_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">set_device</span><span class="p">())</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">biggan_model</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

  <span class="c1"># Back to CPU</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'cpu'</span><span class="p">)</span>

  <span class="c1"># The output layer of BigGAN has a tanh layer,</span>
  <span class="c1"># resulting the range of [-1, 1] for the output image</span>
  <span class="c1"># Therefore, we normalize the images properly to [0, 1]</span>
  <span class="c1"># range.</span>
  <span class="c1"># Clipping is only in case of numerical instability</span>
  <span class="c1"># problems</span>

  <span class="n">output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clip</span><span class="p">(((</span><span class="n">output</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>

<span class="n">z_slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">15</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">description</span><span class="o">=</span><span class="s1">'Z Magnitude'</span><span class="p">,</span>
                     <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'440px'</span><span class="p">))</span>

<span class="n">category_dropdown</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">'tench'</span><span class="p">,</span> <span class="s1">'magpie'</span><span class="p">,</span> <span class="s1">'jellyfish'</span><span class="p">,</span> <span class="s1">'German shepherd'</span><span class="p">,</span> <span class="s1">'bee'</span><span class="p">,</span>
             <span class="s1">'acoustic guitar'</span><span class="p">,</span> <span class="s1">'coffee mug'</span><span class="p">,</span> <span class="s1">'minibus'</span><span class="p">,</span> <span class="s1">'monitor'</span><span class="p">],</span>
             <span class="n">value</span><span class="o">=</span><span class="s2">"German shepherd"</span><span class="p">,</span>
             <span class="n">description</span><span class="o">=</span><span class="s2">"Category: "</span><span class="p">)</span>

<span class="n">widgets_ui</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">category_dropdown</span><span class="p">,</span> <span class="n">z_slider</span><span class="p">])</span>

<span class="n">widgets_out</span> <span class="o">=</span> <span class="n">interactive_output</span><span class="p">(</span><span class="n">sample_from_biggan</span><span class="p">,</span>
                                 <span class="p">{</span>
                                  <span class="s1">'z_magnitude'</span><span class="p">:</span> <span class="n">z_slider</span><span class="p">,</span>
                                  <span class="s1">'category'</span><span class="p">:</span> <span class="n">category_dropdown</span>
                                  <span class="p">}</span>
                                 <span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">widgets_ui</span><span class="p">,</span> <span class="n">widgets_out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8341caf8454341b6a793e8ebdf56bc30"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "036f350cee9f47f4a2e3335076098008"}
</script></div>
</div>
</div>
<div class="section" id="think-1-1-generated-images">
<h3>Think! 1.1: Generated images<a class="headerlink" href="#think-1-1-generated-images" title="Permalink to this headline">¶</a></h3>
<p>As you alter the magnitude of the vector, what do you note about the relationship between the different generated images? What do you note about the relationship between the image and the category label as you increase the magnitude of the vector?</p>
<div class="section" id="student-response">
<h4>Student Response<a class="headerlink" href="#student-response" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Student Response</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>


<span class="n">text</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
   <span class="n">value</span><span class="o">=</span><span class="s1">'Type your answer here and click on `Submit!`'</span><span class="p">,</span>
   <span class="n">placeholder</span><span class="o">=</span><span class="s1">'Type something'</span><span class="p">,</span>
   <span class="n">description</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
   <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Submit!"</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">button</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
   <span class="n">atform</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="s1">'q1'</span> <span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Submission successful!"</span><span class="p">)</span>


<span class="n">button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fa87d285ad104fccab1bcd5aac968a49"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "eb80e48e0dd942fead85fa28f36b953d"}
</script></div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_b8a69093.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<div class="section" id="section-1-2-interpolating-images-with-biggan">
<h2>Section 1.2: Interpolating Images with BigGAN<a class="headerlink" href="#section-1-2-interpolating-images-with-biggan" title="Permalink to this headline">¶</a></h2>
<p>This next widget allows you to interpolate between two generated images. It does this by linearly interpolating between the probability of each category you select and linearly interpolating between the latent vector values.</p>
<div class="section" id="interactive-demo-1-2-biggan-interpolation">
<h3>Interactive Demo 1.2: BigGAN Interpolation<a class="headerlink" href="#interactive-demo-1-2-biggan-interpolation" title="Permalink to this headline">¶</a></h3>
<p>BigGAN Interpolation Widget (the updates may take a few seconds)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown BigGAN Interpolation Widget (the updates may take a few seconds)</span>

<span class="k">def</span> <span class="nf">interpolate_biggan</span><span class="p">(</span><span class="n">category_A</span><span class="p">,</span> <span class="n">z_magnitude_A</span><span class="p">,</span>
                       <span class="n">category_B</span><span class="p">,</span> <span class="n">z_magnitude_B</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Interpolation function with BigGan</span>

<span class="sd">  Args:</span>
<span class="sd">    category_A: string</span>
<span class="sd">      Category specification</span>
<span class="sd">    category_B: string</span>
<span class="sd">      Category specification</span>
<span class="sd">    z_magnitude_A: int</span>
<span class="sd">      Magnitude of z-vector on category_A</span>
<span class="sd">    z_magnitude_B: int</span>
<span class="sd">      Magnitude of z-vector on category_B</span>

<span class="sd">  Returns:</span>
<span class="sd">    Nothing</span>
<span class="sd">  """</span>
  <span class="n">num_interps</span> <span class="o">=</span> <span class="mi">16</span>

  <span class="c1"># category_A = 'jellyfish' #@param ['tench', 'magpie', 'jellyfish', 'German shepherd', 'bee', 'acoustic guitar', 'coffee mug', 'minibus', 'monitor']</span>
  <span class="c1"># z_magnitude_A = 0 #@param {type:"slider", min:-10, max:10, step:1}</span>

  <span class="c1"># category_B = 'German shepherd' #@param ['tench', 'magpie', 'jellyfish', 'German shepherd', 'bee', 'acoustic guitar', 'coffee mug', 'minibus', 'monitor']</span>
  <span class="c1"># z_magnitude_B = 0 #@param {type:"slider", min:-10, max:10, step:1}</span>


  <span class="k">def</span> <span class="nf">interpolate_and_shape</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Function to interpolate and shape images.</span>
<span class="sd">    It does this by linearly interpolating between the</span>
<span class="sd">    probability of each category you select and linearly</span>
<span class="sd">    interpolating between the latent vector values.</span>

<span class="sd">    Args:</span>
<span class="sd">      A: list</span>
<span class="sd">        List of categories</span>
<span class="sd">      B: list</span>
<span class="sd">        List of categories</span>
<span class="sd">      num_interps: int</span>
<span class="sd">        Quantity of pixel grids</span>

<span class="sd">    Returns:</span>
<span class="sd">      Interpolated np.ndarray</span>
<span class="sd">    """</span>
    <span class="n">interps</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">interps</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">interps</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_interps</span><span class="p">,</span> <span class="o">*</span><span class="n">interps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>

  <span class="n">unit_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
  <span class="n">z_A</span> <span class="o">=</span> <span class="n">z_magnitude_A</span> <span class="o">*</span> <span class="n">unit_vector</span>
  <span class="n">z_B</span> <span class="o">=</span> <span class="n">z_magnitude_B</span> <span class="o">*</span> <span class="n">unit_vector</span>
  <span class="n">y_A</span> <span class="o">=</span> <span class="n">one_hot_from_names</span><span class="p">(</span><span class="n">category_A</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">y_B</span> <span class="o">=</span> <span class="n">one_hot_from_names</span><span class="p">(</span><span class="n">category_B</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">z_interp</span> <span class="o">=</span> <span class="n">interpolate_and_shape</span><span class="p">(</span><span class="n">z_A</span><span class="p">,</span> <span class="n">z_B</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">)</span>
  <span class="n">y_interp</span> <span class="o">=</span> <span class="n">interpolate_and_shape</span><span class="p">(</span><span class="n">y_A</span><span class="p">,</span> <span class="n">y_B</span><span class="p">,</span> <span class="n">num_interps</span><span class="p">)</span>

  <span class="c1"># Convert to tensor</span>
  <span class="n">z_interp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">z_interp</span><span class="p">)</span>
  <span class="n">z_interp</span> <span class="o">=</span> <span class="n">z_interp</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
  <span class="n">y_interp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">y_interp</span><span class="p">)</span>

  <span class="c1"># Move to GPU</span>
  <span class="n">z_interp</span> <span class="o">=</span> <span class="n">z_interp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
  <span class="n">y_interp</span> <span class="o">=</span> <span class="n">y_interp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
  <span class="n">biggan_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">biggan_model</span><span class="p">(</span><span class="n">z_interp</span><span class="p">,</span> <span class="n">y_interp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

  <span class="c1"># Back to CPU</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'cpu'</span><span class="p">)</span>

  <span class="c1"># The output layer of BigGAN has a tanh layer,</span>
  <span class="c1"># resulting the range of [-1, 1] for the output image</span>
  <span class="c1"># Therefore, we normalize the images properly to</span>
  <span class="c1"># [0, 1] range.</span>
  <span class="c1"># Clipping is only in case of numerical instability</span>
  <span class="c1"># problems</span>

  <span class="n">output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clip</span><span class="p">(((</span><span class="n">output</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">output</span>

  <span class="c1"># Make grid and show generated samples</span>
  <span class="n">output_grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">output</span><span class="p">,</span>
                                            <span class="n">nrow</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                            <span class="n">padding</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">);</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">output_grid</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">z_A_slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'Z Magnitude A'</span><span class="p">,</span>
                       <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'440px'</span><span class="p">),</span>
                       <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">'description_width'</span><span class="p">:</span> <span class="s1">'initial'</span><span class="p">})</span>

<span class="n">z_B_slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">'Z Magntude B'</span><span class="p">,</span>
                       <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">'440px'</span><span class="p">),</span>
                       <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">'description_width'</span><span class="p">:</span> <span class="s1">'initial'</span><span class="p">})</span>

<span class="n">category_A_dropdown</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">'tench'</span><span class="p">,</span> <span class="s1">'magpie'</span><span class="p">,</span> <span class="s1">'jellyfish'</span><span class="p">,</span> <span class="s1">'German shepherd'</span><span class="p">,</span> <span class="s1">'bee'</span><span class="p">,</span>
             <span class="s1">'acoustic guitar'</span><span class="p">,</span> <span class="s1">'coffee mug'</span><span class="p">,</span> <span class="s1">'minibus'</span><span class="p">,</span> <span class="s1">'monitor'</span><span class="p">],</span>
             <span class="n">value</span><span class="o">=</span><span class="s2">"German shepherd"</span><span class="p">,</span>
             <span class="n">description</span><span class="o">=</span><span class="s2">"Category A: "</span><span class="p">)</span>

<span class="n">category_B_dropdown</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">'tench'</span><span class="p">,</span> <span class="s1">'magpie'</span><span class="p">,</span> <span class="s1">'jellyfish'</span><span class="p">,</span> <span class="s1">'German shepherd'</span><span class="p">,</span> <span class="s1">'bee'</span><span class="p">,</span>
             <span class="s1">'acoustic guitar'</span><span class="p">,</span> <span class="s1">'coffee mug'</span><span class="p">,</span> <span class="s1">'minibus'</span><span class="p">,</span> <span class="s1">'monitor'</span><span class="p">],</span>
             <span class="n">value</span><span class="o">=</span><span class="s2">"jellyfish"</span><span class="p">,</span>
             <span class="n">description</span><span class="o">=</span><span class="s2">"Category B: "</span><span class="p">)</span>



<span class="n">widgets_ui</span> <span class="o">=</span> <span class="n">VBox</span><span class="p">([</span><span class="n">HBox</span><span class="p">([</span><span class="n">category_A_dropdown</span><span class="p">,</span> <span class="n">z_A_slider</span><span class="p">]),</span>
                   <span class="n">HBox</span><span class="p">([</span><span class="n">category_B_dropdown</span><span class="p">,</span> <span class="n">z_B_slider</span><span class="p">])])</span>

<span class="n">widgets_out</span> <span class="o">=</span> <span class="n">interactive_output</span><span class="p">(</span><span class="n">interpolate_biggan</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">'category_A'</span><span class="p">:</span> <span class="n">category_A_dropdown</span><span class="p">,</span>
                                  <span class="s1">'z_magnitude_A'</span><span class="p">:</span> <span class="n">z_A_slider</span><span class="p">,</span>
                                  <span class="s1">'category_B'</span><span class="p">:</span> <span class="n">category_B_dropdown</span><span class="p">,</span>
                                  <span class="s1">'z_magnitude_B'</span><span class="p">:</span> <span class="n">z_B_slider</span><span class="p">})</span>

<span class="n">display</span><span class="p">(</span><span class="n">widgets_ui</span><span class="p">,</span> <span class="n">widgets_out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e355fed0f2e642e3963d4e52addba4da"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "7675de7d6f26437190b512ac3a7b0480"}
</script></div>
</div>
</div>
<div class="section" id="think-1-2-interpolating-samples-from-the-same-category">
<h3>Think! 1.2: Interpolating samples from the same category<a class="headerlink" href="#think-1-2-interpolating-samples-from-the-same-category" title="Permalink to this headline">¶</a></h3>
<p>Try interpolating between samples from the same category, samples from similar categories, and samples from very different categories. Do you notice any trends? What does this suggest about the representations of images in the latent space?</p>
<div class="section" id="id1">
<h4>Student Response<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Student Response</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>


<span class="n">text</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
   <span class="n">value</span><span class="o">=</span><span class="s1">'Type your answer here and click on `Submit!`'</span><span class="p">,</span>
   <span class="n">placeholder</span><span class="o">=</span><span class="s1">'Type something'</span><span class="p">,</span>
   <span class="n">description</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
   <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Submit!"</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">button</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
   <span class="n">atform</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="s1">'q2'</span> <span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Submission successful!"</span><span class="p">)</span>


<span class="n">button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6ecffedca16f4ff7ad91ac2f86ff5582"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "00485dcce031495c93a15ba11b1ee3e9"}
</script></div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_cc13659c.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-latent-variable-models">
<h1>Section 2: Latent Variable Models<a class="headerlink" href="#section-2-latent-variable-models" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~15mins</em> excluding the Bonus</p>
<div class="section" id="video-2-latent-variable-models">
<h2>Video 2: Latent Variable Models<a class="headerlink" href="#video-2-latent-variable-models" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b3ba09c8e80842c99a35b9256a954dfb"}
</script></div>
</div>
<p>In the video, the concept of a latent variable model was introduced. We saw how PCA (principal component analysis) can be extended into a generative model with latent variables called pPCA. For pPCA the latent variables (z in the video) are the projections onto the principal component axes.</p>
<p>The dimensionality of the principal components is typically set to be substantially lower-dimensional than the original data. Thus, the latent variables (the projection onto the principal component axes) are a lower-dimensional representation of the original data (dimensionality reduction!). With pPCA we can estimate the original distribution of the high dimensional data. This allows us to generate data with a distribution that “looks” more like the original data than if we were to only use PCA to generate data from the latent variables. Let’s see how that might look with a simple example.</p>
</div>
<div class="section" id="coding-exercise-2-ppca-bonus">
<h2>Coding Exercise 2: pPCA (Bonus)<a class="headerlink" href="#coding-exercise-2-ppca-bonus" title="Permalink to this headline">¶</a></h2>
<p>Assume we have two noisy thermometers measuring the temperature of the same room. They both make noisy measurements.  The room tends to be around 25°C (that’s 77°F), but can vary around that temperature.  If we take lots of readings from the two thermometers over time and plot the paired readings, we might see something like the plot generated below:</p>
<p>Generate example datapoints from the two thermometers</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Generate example datapoints from the two thermometers</span>

<span class="k">def</span> <span class="nf">generate_data</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">mean_of_temps</span><span class="p">,</span> <span class="n">cov_of_temps</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generate random data, normally distributed</span>

<span class="sd">  Args:</span>
<span class="sd">    n_samples : int</span>
<span class="sd">      The number of samples to be generated</span>
<span class="sd">    mean_of_temps : numpy.ndarray</span>
<span class="sd">      1D array with the mean of temparatures, Kx1</span>
<span class="sd">    cov_of_temps : numpy.ndarray</span>
<span class="sd">      2D array with the covariance, , KxK</span>
<span class="sd">    seed : int</span>
<span class="sd">      Set random seed for the psudo random generator</span>

<span class="sd">  Returns:</span>
<span class="sd">    therm1 : numpy.ndarray</span>
<span class="sd">      Thermometer 1</span>
<span class="sd">    therm2 : numpy.ndarray</span>
<span class="sd">      Thermometer 2</span>
<span class="sd">  """</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean_of_temps</span><span class="p">,</span>
                                                <span class="n">cov_of_temps</span><span class="p">,</span>
                                                <span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
  <span class="k">return</span> <span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span>


<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">mean_of_temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">cov_of_temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span> <span class="o">=</span> <span class="n">generate_data</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">mean_of_temps</span><span class="p">,</span> <span class="n">cov_of_temps</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Thermometer 1 ($^\circ$C)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Thermometer 2 ($^\circ$C)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/W2D4_Tutorial1_53_0.png" src="../../../_images/W2D4_Tutorial1_53_0.png"/>
</div>
</div>
<p>Let’s model these data with a single principal component. Given that the thermometers are measuring the same actual temperature, the principal component axes will be the identity line. The direction of this axes can be indicated by the unit vector <span class="math notranslate nohighlight">\([1 ~~ 1]~/~\sqrt2\)</span>.  We could estimate this axes by applying PCA. We can plot this axes, it tells us something about the data, but we can’t generate from it:</p>
<p>Add first PC axes to the plot</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Add first PC axes to the plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span><span class="p">,</span> <span class="s1">'.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Thermometer 1 ($^\circ$C)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Thermometer 2 ($^\circ$C)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>
         <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/W2D4_Tutorial1_56_0.png" src="../../../_images/W2D4_Tutorial1_56_0.png"/>
</div>
</div>
<p><strong>Step 1:</strong> Calculate the parameters of the pPCA model</p>
<p>This part is completed already, so you don’t need to make any edits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Project Data onto the principal component axes.</span>
<span class="c1"># We could have "learned" this from the data by applying PCA,</span>
<span class="c1"># but we "know" the value from the problem definition.</span>
<span class="n">pc_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

<span class="c1"># Thermometers data</span>
<span class="n">therm_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">therm1</span><span class="p">,</span> <span class="n">therm2</span><span class="p">])</span>

<span class="c1"># Zero center the data</span>
<span class="n">therm_data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">therm_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">therm_data_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">therm_data_mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">therm_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">therm_data_zero_centered</span> <span class="o">=</span> <span class="n">therm_data</span> <span class="o">-</span> <span class="n">therm_data_center</span>

<span class="c1"># Calculate the variance of the projection on the PC axes</span>
<span class="n">pc_projection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">pc_axes</span><span class="p">,</span> <span class="n">therm_data_zero_centered</span><span class="p">);</span>
<span class="n">pc_axes_variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">pc_projection</span><span class="p">)</span>

<span class="c1"># Calculate the residual variance (variance not accounted for by projection on the PC axes)</span>
<span class="n">sensor_noise_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">therm_data_zero_centered</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">pc_axes</span><span class="p">,</span> <span class="n">pc_projection</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sensor_noise_var</span> <span class="o">=</span> <span class="n">sensor_noise_std</span> <span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Step 2</strong>: “Generate” from the pPCA model of the thermometer data.</p>
<p>Complete the code so it properly generates from the pPCA model. At present we aren’t accounting for the “sensor noise” the sensor noise is the variance that the PC axes isn’t accounting for. Thus, you’ll note that the current output sits on the PC axes and doesn’t look like the original data distribution!!</p>
<p>Here is the equation for sampling from the pPCA model:</p>
<div class="amsmath math notranslate nohighlight" id="equation-25d25335-0ab7-4752-817f-b1a243f0e41b">
<span class="eqno">(86)<a class="headerlink" href="#equation-25d25335-0ab7-4752-817f-b1a243f0e41b" title="Permalink to this equation">¶</a></span>\[\begin{equation}
x = \mu + W z + \epsilon, \,\text{where}\,~~ \epsilon \sim \mathcal{N}(0,~\sigma^2 \mathbf{I})
\end{equation}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gen_from_pPCA</span><span class="p">(</span><span class="n">noise_var</span><span class="p">,</span> <span class="n">data_mean</span><span class="p">,</span> <span class="n">pc_axes</span><span class="p">,</span> <span class="n">pc_variance</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generate samples from pPCA</span>

<span class="sd">  Args:</span>
<span class="sd">    noise_var: np.ndarray</span>
<span class="sd">      Sensor noise variance</span>
<span class="sd">    data_mean: np.ndarray</span>
<span class="sd">      Thermometer data mean</span>
<span class="sd">    pc_axes: np.ndarray</span>
<span class="sd">      Principal component axes</span>
<span class="sd">    pc_variance: np.ndarray</span>
<span class="sd">      The variance of the projection on the PC axes</span>

<span class="sd">  Returns:</span>
<span class="sd">    therm_data_sim: np.ndarray</span>
<span class="sd">      Generated (simulate, draw) `n_samples` from pPCA model</span>
<span class="sd">  """</span>
  <span class="c1"># We are matching this value to the thermometer data so the visualizations look similar</span>
  <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

  <span class="c1"># Randomly sample from z (latent space value)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pc_variance</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span>

  <span class="c1"># Sensor noise covariance matrix (∑)</span>
  <span class="n">epsilon_cov</span> <span class="o">=</span> <span class="p">[[</span><span class="n">noise_var</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">noise_var</span><span class="p">]]</span>

  <span class="c1"># Data mean reshaped for the generation</span>
  <span class="n">sim_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">data_mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_samples</span><span class="p">))</span>

  <span class="c1">####################################################################</span>
  <span class="c1"># Fill in all missing code below (...),</span>
  <span class="c1"># then remove or comment the line below to test your class</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the `gen_from_pPCA` function"</span><span class="p">)</span>
  <span class="c1">####################################################################</span>
  <span class="c1"># Draw `n_samples` from `np.random.multivariate_normal`</span>
  <span class="n">rand_eps</span> <span class="o">=</span> <span class="o">...</span>
  <span class="n">rand_eps</span> <span class="o">=</span> <span class="n">rand_eps</span><span class="o">.</span><span class="n">T</span>

  <span class="c1"># Generate (simulate, draw) `n_samples` from pPCA model</span>
  <span class="n">therm_data_sim</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">therm_data_sim</span>


<span class="c1"># Add event to airtable</span>
<span class="n">atform</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">'Coding Exercise 2: pPCA'</span><span class="p">)</span>

<span class="c1">## Uncomment to test your code</span>
<span class="c1"># therm_data_sim = gen_from_pPCA(sensor_noise_var, therm_data_mean, pc_axes, pc_axes_variance)</span>
<span class="c1"># plot_gen_samples_ppca(therm1, therm2, therm_data_sim)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_edeaa9a6.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_edeaa9a6_0.png"><img align="center" alt="Solution hint" class="align-center" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_edeaa9a6_0.png" style="width: 1120.0px; height: 832.0px;"/></a>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-autoencoders">
<h1>Section 3: Autoencoders<a class="headerlink" href="#section-3-autoencoders" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~30mins</em></p>
<p><strong>Please</strong> run the cell after the video to download MNIST and CIFAR10 image datasets while the video plays.</p>
<div class="section" id="video-3-autoenconders">
<h2>Video 3: Autoenconders<a class="headerlink" href="#video-3-autoenconders" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "dda05adb2c2b4bb6a215e70c56bc0cb1"}
</script></div>
</div>
<p>Download MNIST and CIFAR10 datasets</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Download MNIST and CIFAR10 datasets</span>
<span class="kn">import</span> <span class="nn">tarfile</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">os</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">'MNIST.tar.gz'</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">'mnist'</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://osf.io/y2fj6/download'</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Downloading MNIST dataset...'</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Downloading MNIST completed!</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
    <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'MNIST dataset has been downloaded.</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>


<span class="n">fname</span> <span class="o">=</span> <span class="s1">'cifar-10-python.tar.gz'</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">'cifar10'</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">'https://osf.io/jbpme/download'</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Downloading CIFAR10 dataset...'</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">Downloading CIFAR10 completed!'</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
    <span class="n">tar</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">'CIFAR10 dataset has been dowloaded.'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading MNIST dataset...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading MNIST completed!
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading CIFAR10 dataset...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading CIFAR10 completed!
</pre></div>
</div>
</div>
</div>
<p>Load MNIST and CIFAR10 image datasets</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Load MNIST and CIFAR10 image datasets</span>
<span class="c1"># See https://pytorch.org/docs/stable/torchvision/datasets.html</span>

<span class="c1"># MNIST</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'./mnist/'</span><span class="p">,</span>
                       <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                       <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mnist_val</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="s1">'./mnist/'</span><span class="p">,</span>
                           <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                           <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># CIFAR 10</span>
<span class="n">cifar10</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="s1">'./cifar10/'</span><span class="p">,</span>
                           <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                           <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cifar10_val</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="s1">'./cifar10/'</span><span class="p">,</span>
                               <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
                               <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="select-a-dataset">
<h3>Select a dataset<a class="headerlink" href="#select-a-dataset" title="Permalink to this headline">¶</a></h3>
<p>We’ve built today’s tutorial to be flexible. It should work more-or-less out of the box with both MNIST and CIFAR (and other image datasets). MNIST is in many ways simpler, and the results will likely look better and run a bit faster if using MNIST. But we are leaving it up to you to pick which one you want to experiment with!</p>
<p>We encourage pods to coordinate so that some members use MNIST and others use CIFAR10. Keep in mind that the CIFAR dataset may require more learning epochs (longer training required).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'mnist'</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Get data</span>

<span class="sd">  Args:</span>
<span class="sd">    name: string</span>
<span class="sd">      Name of the dataset</span>

<span class="sd">  Returns:</span>
<span class="sd">    my_dataset: dataset instance</span>
<span class="sd">      Instance of dataset</span>
<span class="sd">    my_dataset_name: string</span>
<span class="sd">      Name of the dataset</span>
<span class="sd">    my_dataset_shape: tuple</span>
<span class="sd">      Shape of dataset</span>
<span class="sd">    my_dataset_size: int</span>
<span class="sd">      Size of dataset</span>
<span class="sd">    my_valset: torch.loader</span>
<span class="sd">      Validation loader</span>
<span class="sd">  """</span>
  <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">'mnist'</span><span class="p">:</span>
    <span class="n">my_dataset_name</span> <span class="o">=</span> <span class="s2">"MNIST"</span>
    <span class="n">my_dataset</span> <span class="o">=</span> <span class="n">mnist</span>
    <span class="n">my_valset</span> <span class="o">=</span> <span class="n">mnist_val</span>
    <span class="n">my_dataset_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
    <span class="n">my_dataset_size</span> <span class="o">=</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span>
  <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">'cifar10'</span><span class="p">:</span>
    <span class="n">my_dataset_name</span> <span class="o">=</span> <span class="s2">"CIFAR10"</span>
    <span class="n">my_dataset</span> <span class="o">=</span> <span class="n">cifar10</span>
    <span class="n">my_valset</span> <span class="o">=</span> <span class="n">cifar10_val</span>
    <span class="n">my_dataset_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">my_dataset_size</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">32</span>

  <span class="k">return</span> <span class="n">my_dataset</span><span class="p">,</span> <span class="n">my_dataset_name</span><span class="p">,</span> <span class="n">my_dataset_shape</span><span class="p">,</span> <span class="n">my_dataset_size</span><span class="p">,</span> <span class="n">my_valset</span>


<span class="n">train_set</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">data_shape</span><span class="p">,</span> <span class="n">data_size</span><span class="p">,</span> <span class="n">valid_set</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'mnist'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-3-1-conceptual-introduction-to-autoencoders">
<h2>Section 3.1: Conceptual introduction to AutoEncoders<a class="headerlink" href="#section-3-1-conceptual-introduction-to-autoencoders" title="Permalink to this headline">¶</a></h2>
<p>Now we’ll create our first autoencoder. It will reduce images down to <span class="math notranslate nohighlight">\(K\)</span> dimensions. The architecture will be quite simple: the input will be linearly mapped to a single hidden (or latent) layer <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> with <span class="math notranslate nohighlight">\(K\)</span> units, which will then be linearly mapped back to an output that is the same size as the input:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e6ea8ffd-3a56-4bbe-b1cf-c27468dd94c6">
<span class="eqno">(87)<a class="headerlink" href="#equation-e6ea8ffd-3a56-4bbe-b1cf-c27468dd94c6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{x} \longrightarrow \mathbf{h} \longrightarrow \mathbf{x'}
\end{equation}\]</div>
<p>The loss function we’ll use will simply be mean squared error (MSE) quantifying how well the reconstruction (<span class="math notranslate nohighlight">\(\mathbf{x'}\)</span>) matches the original image (<span class="math notranslate nohighlight">\(\mathbf{x}\)</span>):</p>
<div class="amsmath math notranslate nohighlight" id="equation-4e02a226-ad95-4ace-bfba-7ccbd9476634">
<span class="eqno">(88)<a class="headerlink" href="#equation-4e02a226-ad95-4ace-bfba-7ccbd9476634" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\text{MSE Loss} = \sum_{i=1}^{N} ||\mathbf{x}_i - \mathbf{x'}_i||^2_2
\end{equation}\]</div>
<p>If all goes well, then the AutoEncoder will learn, <strong>end to end</strong>, a good “encoding” or “compression” of inputs to a latent representation (<span class="math notranslate nohighlight">\(\mathbf{x \longrightarrow h}\)</span>) as well as a good “decoding” of that latent representation to a reconstruction of the original input (<span class="math notranslate nohighlight">\(\mathbf{h \longrightarrow x'}\)</span>).</p>
<p>The first choice to make is the dimensionality of <span class="math notranslate nohighlight">\(\mathbf{h}\)</span>. We’ll see more on this below, but For MNIST, 5 to 20 is plenty. For CIFAR, we need more like 50 to 100 dimensions.</p>
<p>Coordinate with your pod to try a variety of values for <span class="math notranslate nohighlight">\(K\)</span> in each dataset so you can compare results.</p>
<div class="section" id="coding-exercise-3-1-linear-autoencoder-architecture">
<h3>Coding Exercise 3.1: Linear AutoEncoder Architecture<a class="headerlink" href="#coding-exercise-3-1-linear-autoencoder-architecture" title="Permalink to this headline">¶</a></h3>
<p>Complete the missing parts of the <code class="docutils literal notranslate"><span class="pre">LinearAutoEncoder</span></code> class.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LinearAutoEncoder</span></code> as two stages: an <code class="docutils literal notranslate"><span class="pre">encoder</span></code> which linearly maps from inputs of size <code class="docutils literal notranslate"><span class="pre">x_dim</span> <span class="pre">=</span> <span class="pre">my_dataset_dim</span></code> to a hidden layer of size <code class="docutils literal notranslate"><span class="pre">h_dim</span> <span class="pre">=</span> <span class="pre">K</span></code> (with no nonlinearity), and a <code class="docutils literal notranslate"><span class="pre">decoder</span></code> which maps back from <code class="docutils literal notranslate"><span class="pre">K</span></code> up to the number of pixels in each image.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown #### Run to define the `train_autoencoder` function.</span>
<span class="c1"># @markdown Feel free to inspect the training function if the time allows.</span>

<span class="c1"># @markdown `train_autoencoder(autoencoder, dataset, device, epochs=20, batch_size=250, seed=0)`</span>


<span class="k">def</span> <span class="nf">train_autoencoder</span><span class="p">(</span><span class="n">autoencoder</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                      <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Function to train autoencoder</span>

<span class="sd">  Args:</span>
<span class="sd">    autoencoder: nn.module</span>
<span class="sd">      Autoencoder instance</span>
<span class="sd">    dataset: function</span>
<span class="sd">      Dataset</span>
<span class="sd">    device: string</span>
<span class="sd">      GPU if available. CPU otherwise</span>
<span class="sd">    epochs: int</span>
<span class="sd">      Number of epochs [default: 20]</span>
<span class="sd">    batch_size: int</span>
<span class="sd">      Batch size</span>
<span class="sd">    seed: int</span>
<span class="sd">      Set seed for reproducibility; [default: 0]</span>

<span class="sd">  Returns:</span>
<span class="sd">    mse_loss: float</span>
<span class="sd">      MSE Loss</span>
<span class="sd">  """</span>
  <span class="n">autoencoder</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
  <span class="n">optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">autoencoder</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span>
                           <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
                           <span class="n">weight_decay</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
  <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
  <span class="n">g_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
  <span class="n">g_seed</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                      <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                      <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
                      <span class="n">generator</span><span class="o">=</span><span class="n">g_seed</span><span class="p">)</span>

  <span class="n">mse_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">epochs</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">//</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">'Epoch'</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">im_batch</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
      <span class="n">im_batch</span> <span class="o">=</span> <span class="n">im_batch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
      <span class="n">optim</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">reconstruction</span> <span class="o">=</span> <span class="n">autoencoder</span><span class="p">(</span><span class="n">im_batch</span><span class="p">)</span>
      <span class="c1"># Loss calculation</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">reconstruction</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                     <span class="n">target</span><span class="o">=</span><span class="n">im_batch</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">optim</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

      <span class="n">mse_loss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="c1"># After training completes,</span>
  <span class="c1"># make sure the model is on CPU so we can easily</span>
  <span class="c1"># do more visualizations and demos.</span>
  <span class="n">autoencoder</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'cpu'</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">mse_loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LinearAutoEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Linear Autoencoder</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">,</span> <span class="n">h_dim</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    A Linear AutoEncoder</span>

<span class="sd">    Args:</span>
<span class="sd">      x_dim: int</span>
<span class="sd">        Input dimension</span>
<span class="sd">      h_dim: int</span>
<span class="sd">        Hidden dimension, bottleneck dimension, K</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Fill in all missing code below (...),</span>
    <span class="c1"># then remove or comment the line below to test your class</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the LinearAutoEncoder class!"</span><span class="p">)</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Encoder layer (a linear mapping from x_dim to K)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_lin</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Decoder layer (a linear mapping from K to x_dim)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_lin</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Encoder function</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Encoded output</span>
<span class="sd">    """</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Fill in all missing code below (...),</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the `encode` function!"</span><span class="p">)</span>
    <span class="c1">####################################################################</span>
    <span class="n">h</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">h</span>

  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Decoder function</span>

<span class="sd">    Args:</span>
<span class="sd">      h: torch.tensor</span>
<span class="sd">        Encoded output</span>

<span class="sd">    Returns:</span>
<span class="sd">      x_prime: torch.tensor</span>
<span class="sd">        Decoded output</span>
<span class="sd">    """</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Fill in all missing code below (...),</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the `decode` function!"</span><span class="p">)</span>
    <span class="c1">####################################################################</span>
    <span class="n">x_prime</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">x_prime</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Forward pass</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input data</span>

<span class="sd">    Returns:</span>
<span class="sd">      Decoded output</span>
<span class="sd">    """</span>
    <span class="n">flat_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">flat_x</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>


<span class="c1"># Add event to airtable</span>
<span class="n">atform</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">'Coding Exercise 3.1: Linear AutoEncoder Architecture'</span><span class="p">)</span>

<span class="c1"># Pick your own K</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1">## Uncomment to test your code</span>
<span class="c1"># lin_ae = LinearAutoEncoder(data_size, K)</span>
<span class="c1"># lin_losses = train_autoencoder(lin_ae, train_set, device=DEVICE, seed=SEED)</span>
<span class="c1"># plot_linear_ae(lin_losses)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_ed94be6b.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_ed94be6b_2.png"><img align="center" alt="Solution hint" class="align-center" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_ed94be6b_2.png" style="width: 1119.0px; height: 832.0px;"/></a>
</div>
<div class="section" id="comparison-to-pca">
<h3>Comparison to PCA<a class="headerlink" href="#comparison-to-pca" title="Permalink to this headline">¶</a></h3>
<p>One way to think about AutoEncoders is as a form of dimensionality-reduction. The dimensionality of <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> is much smaller than the dimensionality of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>.</p>
<p>Another common technique for dimensionality reduction is to project data onto the top <span class="math notranslate nohighlight">\(K\)</span> <strong>principal components</strong> (Principal Component Analysis or PCA). For comparison, let’s also apply PCA for dimensionality reduction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PCA requires finding the top K eigenvectors of the data covariance. Start by</span>
<span class="c1"># finding the mean and covariance of the pixels in our dataset</span>
<span class="n">g_seed</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
<span class="n">g_seed</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
                    <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">seed_worker</span><span class="p">,</span>
                    <span class="n">generator</span><span class="o">=</span><span class="n">g_seed</span><span class="p">)</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">image_moments</span><span class="p">((</span><span class="n">im</span> <span class="k">for</span> <span class="n">im</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">),</span>
                        <span class="n">n_batches</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span> <span class="o">//</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">pca_encode</span><span class="p">,</span> <span class="n">pca_decode</span> <span class="o">=</span> <span class="n">pca_encoder_decoder</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1d9b9c8edfbf49109785188b69db3515"}
</script></div>
</div>
<p>Let’s visualize some of the reconstructions (<span class="math notranslate nohighlight">\(\mathbf{x'}\)</span>) side-by-side with the input images (<span class="math notranslate nohighlight">\(\mathbf{x}\)</span>).</p>
<p>Visualize the reconstructions <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>, run this code a few times to see different examples.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Visualize the reconstructions $\mathbf{x}'$, run this code a few times to see different examples.</span>

<span class="n">n_plot</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_plot</span><span class="p">):</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">())</span>
  <span class="n">image</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_set</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
  <span class="c1"># Get reconstructed image from autoencoder</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">reconstruction</span> <span class="o">=</span> <span class="n">lin_ae</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>

  <span class="c1"># Get reconstruction from PCA dimensionality reduction</span>
  <span class="n">h_pca</span> <span class="o">=</span> <span class="n">pca_encode</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="n">recon_pca</span> <span class="o">=</span> <span class="n">pca_decode</span><span class="p">(</span><span class="n">h_pca</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Original</span><span class="se">\n</span><span class="s1">Image'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_plot</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">reconstruction</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Lin AE</span><span class="se">\n</span><span class="s1">(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_plot</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">recon_pca</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'PCA</span><span class="se">\n</span><span class="s1">(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
</div>
<div class="section" id="think-3-1-pca-vs-linear-autoenconder">
<h3>Think! 3.1: PCA vs. Linear autoenconder<a class="headerlink" href="#think-3-1-pca-vs-linear-autoenconder" title="Permalink to this headline">¶</a></h3>
<p>Compare the PCA-based reconstructions to those from the linear autoencoder. Is one better than the other? Are they equally good? Equally bad? How does the choice of <span class="math notranslate nohighlight">\(K\)</span> impact reconstruction quality?</p>
<div class="section" id="id2">
<h4>Student Response<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Student Response</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>


<span class="n">text</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
   <span class="n">value</span><span class="o">=</span><span class="s1">'Type your answer here and click on `Submit!`'</span><span class="p">,</span>
   <span class="n">placeholder</span><span class="o">=</span><span class="s1">'Type something'</span><span class="p">,</span>
   <span class="n">description</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span>
   <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">"Submit!"</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="n">button</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
   <span class="n">atform</span><span class="o">.</span><span class="n">add_answer</span><span class="p">(</span><span class="s1">'q3'</span> <span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Submission successful!"</span><span class="p">)</span>


<span class="n">button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">on_button_clicked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d956b5b6e894434b978dd09ac3158e23"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "797462a3465c4275a6aceb09410a8a51"}
</script></div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_35acaa17.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<div class="section" id="section-3-2-building-a-nonlinear-convolutional-autoencoder">
<h2>Section 3.2: Building a nonlinear convolutional autoencoder<a class="headerlink" href="#section-3-2-building-a-nonlinear-convolutional-autoencoder" title="Permalink to this headline">¶</a></h2>
<p><strong>Nonlinear:</strong> We’d like to apply autoencoders to learn a more flexible nonlinear mapping between the latent space and the images. Such a mapping can provide a more “expressive” model that better describes the image data than a linear mapping. This can be achieved by adding nonlinear activation functions to our encoder and decoder!</p>
<p><strong>Convolutional:</strong> As you saw on the day dedicated to RNNs and CNNs, parameter sharing is often a good idea for images! It’s quite common to use convolutional layers in autoencoders to share parameters across locations in the image.</p>
<p><strong>Side Note:</strong> The <code class="docutils literal notranslate"><span class="pre">nn.Linear</span></code> layer (used in the linear autoencoder above) has a “bias” term, which is a learnable offset parameter separate for each output unit. Just like PCA “centers” the data by subtracting off the mean image (<code class="docutils literal notranslate"><span class="pre">mu</span></code>) before encoding and adds the average back in during decoding, a bias term in the decoder can effectively account for the first moment (mean) of the data (i.e. the average of all images in the training set). Convolution layers do have bias parameters, but the bias is applied per filter rather than per pixel location. If we’re generating grayscale images (like those in MNIST), then <code class="docutils literal notranslate"><span class="pre">Conv2d</span></code> will learn only one bias across the entire image.</p>
<p>For some conceptual continuity with both PCA and the <code class="docutils literal notranslate"><span class="pre">nn.Linear</span></code> layers above, the next block defines a custom <code class="docutils literal notranslate"><span class="pre">BiasLayer</span></code> for adding a learnable per-pixel offset. This custom layer will be used twice: as the first stage of the encoder and as the final stage of the decoder. Ideally, this means that the rest of the neural net can focus on fitting more interesting fine-grained structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BiasLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Bias Layer</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Initialise parameters of bias layer</span>

<span class="sd">    Args:</span>
<span class="sd">      shape: tuple</span>
<span class="sd">        Requisite shape of bias layer</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">BiasLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="n">init_bias</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">init_bias</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Forward pass</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      Output of bias layer</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
</pre></div>
</div>
</div>
</div>
<p>With that out of the way, we will next define a <strong>nonlinear</strong> and <strong>convolutional</strong> autoencoder. Here’s a quick tour of the architecture:</p>
<ol class="simple">
<li><p>The <strong>encoder</strong> once again maps from images to <span class="math notranslate nohighlight">\(\mathbf{h}\in\mathbb{R}^K\)</span>. This will use a <code class="docutils literal notranslate"><span class="pre">BiasLayer</span></code> followed by two convolutional layers (<code class="docutils literal notranslate"><span class="pre">nn.Conv2D</span></code>), followed by flattening and linearly projecting down to <span class="math notranslate nohighlight">\(K\)</span> dimensions. The convolutional layers will have <code class="docutils literal notranslate"><span class="pre">ReLU</span></code> nonlinearities on their outputs.</p></li>
<li><p>The <strong>decoder</strong> inverts this process, taking in vectors of length <span class="math notranslate nohighlight">\(K\)</span> and outputting images. Roughly speaking, its architecture is a “mirror image” of the encoder: the first decoder layer is linear, followed by two <strong>deconvolution</strong> layers (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.ConvTranspose2d.html"><code class="docutils literal notranslate"><span class="pre">ConvTranspose2d</span></code></a>). The <code class="docutils literal notranslate"><span class="pre">ConvTranspose2d</span></code>layers will have <code class="docutils literal notranslate"><span class="pre">ReLU</span></code> nonlinearities on their <em>inputs</em>. This “mirror image” between the encoder and decoder is a useful and near-ubiquitous convention. The idea is that the decoder can then learn to approximately invert the encoder, but it is not a strict requirement (and it does not guarantee the decoder will be an exact inverse of the encoder!).</p></li>
</ol>
<p>Below is a schematic of the architecture for MNIST. Notice that the width and height dimensions of the image planes reduce after each <code class="docutils literal notranslate"><span class="pre">nn.Conv2d</span></code> and increase after each <code class="docutils literal notranslate"><span class="pre">nn.ConvTranspose2d</span></code>. With CIFAR10, the architecture is the same but the exact sizes will differ.</p>
<img alt="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/conv_sizes.png" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/conv_sizes.png"/>
<p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.ConvTranspose2d.html"><code class="docutils literal notranslate"><span class="pre">torch.nn.ConvTranspose2d</span></code></a> module can be seen as the gradient of <code class="docutils literal notranslate"><span class="pre">Conv2d</span></code> with respect to its input. It is also known as a fractionally-strided convolution or a deconvolution (although it is not an actual deconvolution operation). The following code demonstrates this change in sizes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dummy_image</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">in_channels</span> <span class="o">=</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">out_channels</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">dummy_conv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">in_channels</span><span class="p">,</span>
                       <span class="n">out_channels</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span>
                       <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">dummy_deconv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">out_channels</span><span class="p">,</span>
                                  <span class="n">out_channels</span><span class="o">=</span><span class="n">in_channels</span><span class="p">,</span>
                                  <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Size of image is </span><span class="si">{</span><span class="n">dummy_image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Size of Conv2D(image) </span><span class="si">{</span><span class="n">dummy_conv</span><span class="p">(</span><span class="n">dummy_image</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Size of ConvTranspose2D(Conv2D(image)) </span><span class="si">{</span><span class="n">dummy_deconv</span><span class="p">(</span><span class="n">dummy_conv</span><span class="p">(</span><span class="n">dummy_image</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Size of image is torch.Size([1, 1, 28, 28])
Size of Conv2D(image) torch.Size([1, 7, 24, 24])
Size of ConvTranspose2D(Conv2D(image)) torch.Size([1, 1, 28, 28])
</pre></div>
</div>
</div>
</div>
<div class="section" id="coding-exercise-3-2-fill-in-code-for-the-convautoencoder-module">
<h3>Coding Exercise 3.2: Fill in code for the <code class="docutils literal notranslate"><span class="pre">ConvAutoEncoder</span></code> module<a class="headerlink" href="#coding-exercise-3-2-fill-in-code-for-the-convautoencoder-module" title="Permalink to this headline">¶</a></h3>
<p>Complete the <code class="docutils literal notranslate"><span class="pre">ConvAutoEncoder</span></code> class. We use the helper function <code class="docutils literal notranslate"><span class="pre">cout(torch.Tensor,</span> <span class="pre">nn.Conv2D)</span></code> to calculate the output shape of a <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html"><code class="docutils literal notranslate"><span class="pre">nn.Conv2D</span></code></a> layer given a tensor with shape (channels, height, width).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ConvAutoEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  A Convolutional AutoEncoder</span>
<span class="sd">  """</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">,</span> <span class="n">h_dim</span><span class="p">,</span> <span class="n">n_filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Initialize parameters of ConvAutoEncoder</span>

<span class="sd">    Args:</span>
<span class="sd">      x_dim: tuple</span>
<span class="sd">        Input dimensions (channels, height, widths)</span>
<span class="sd">      h_dim: int</span>
<span class="sd">        Hidden dimension, bottleneck dimension, K</span>
<span class="sd">      n_filters: int</span>
<span class="sd">        Number of filters (number of output channels)</span>
<span class="sd">      filter_size: int</span>
<span class="sd">        Kernel size</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="n">channels</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">widths</span> <span class="o">=</span> <span class="n">x_dim</span>

    <span class="c1"># Encoder input bias layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_bias</span> <span class="o">=</span> <span class="n">BiasLayer</span><span class="p">(</span><span class="n">x_dim</span><span class="p">)</span>

    <span class="c1"># First encoder conv2d layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">n_filters</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span>

    <span class="c1"># Output shape of the first encoder conv2d layer given x_dim input</span>
    <span class="n">conv_1_shape</span> <span class="o">=</span> <span class="n">cout</span><span class="p">(</span><span class="n">x_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_1</span><span class="p">)</span>

    <span class="c1"># Second encoder conv2d layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">n_filters</span><span class="p">,</span> <span class="n">n_filters</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span>

    <span class="c1"># Output shape of the second encoder conv2d layer given conv_1_shape input</span>
    <span class="n">conv_2_shape</span> <span class="o">=</span> <span class="n">cout</span><span class="p">(</span><span class="n">conv_1_shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_2</span><span class="p">)</span>

    <span class="c1"># The bottleneck is a dense layer, therefore we need a flattenning layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>

    <span class="c1"># Conv output shape is (depth, height, width), so the flatten size is:</span>
    <span class="n">flat_after_conv</span> <span class="o">=</span> <span class="n">conv_2_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">conv_2_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">conv_2_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Encoder Linear layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enc_lin</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">flat_after_conv</span><span class="p">,</span> <span class="n">h_dim</span><span class="p">)</span>

    <span class="c1">####################################################################</span>
    <span class="c1"># Fill in all missing code below (...),</span>
    <span class="c1"># then remove or comment the line below to test your class</span>
    <span class="c1"># Remember that decoder is "undo"-ing what the encoder has done!</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the `ConvAutoEncoder` class!"</span><span class="p">)</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Decoder Linear layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_lin</span> <span class="o">=</span> <span class="o">...</span>

    <span class="c1"># Unflatten data to (depth, height, width) shape</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_unflatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Unflatten</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">unflattened_size</span><span class="o">=</span><span class="n">conv_2_shape</span><span class="p">)</span>

    <span class="c1"># First "deconvolution" layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_deconv_1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="n">n_filters</span><span class="p">,</span> <span class="n">n_filters</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span>

    <span class="c1"># Second "deconvolution" layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_deconv_2</span> <span class="o">=</span> <span class="o">...</span>

    <span class="c1"># Decoder output bias layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dec_bias</span> <span class="o">=</span> <span class="n">BiasLayer</span><span class="p">(</span><span class="n">x_dim</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Encoder</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      h: torch.tensor</span>
<span class="sd">        Encoded output</span>
<span class="sd">    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_bias</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_1</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enc_conv_2</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_flatten</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_lin</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span>

  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Decoder</span>

<span class="sd">    Args:</span>
<span class="sd">      h: torch.tensor</span>
<span class="sd">        Encoded output</span>

<span class="sd">    Returns:</span>
<span class="sd">      x_prime: torch.tensor</span>
<span class="sd">        Decoded output</span>
<span class="sd">    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec_lin</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec_unflatten</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec_deconv_1</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec_deconv_2</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">x_prime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec_bias</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_prime</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Forward pass</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      Decoded output</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="c1"># Add event to airtable</span>
<span class="n">atform</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">'Coding Exercise 3.2: Fill in code for the ConvAutoEncoder module'</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1">## Uncomment to test your solution</span>
<span class="c1"># trained_conv_AE = ConvAutoEncoder(data_shape, K)</span>
<span class="c1"># assert trained_conv_AE.encode(train_set[0][0].unsqueeze(0)).numel() == K, "Encoder output size should be K!"</span>
<span class="c1"># conv_losses = train_autoencoder(trained_conv_AE, train_set, device=DEVICE, seed=SEED)</span>
<span class="c1"># plot_conv_ae(lin_losses, conv_losses)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_9b465f28.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_9b465f28_2.png"><img align="center" alt="Solution hint" class="align-center" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_9b465f28_2.png" style="width: 1119.0px; height: 832.0px;"/></a>
<p>You should see that the <code class="docutils literal notranslate"><span class="pre">ConvAutoEncoder</span></code> achieved lower MSE loss than the linear one. If not, you may need to retrain it (or run another few training epochs from where it left off). We make fewer guarantees on this working with CIFAR10, but it should definitely work with MNIST.</p>
<p>Now let’s visually compare the reconstructed images from the linear and nonlinear autoencoders. Keep in mind that both have the same dimensionality for <span class="math notranslate nohighlight">\(\mathbf{h}\)</span>!</p>
<p>Visualize the linear and nonlinear AE outputs</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Visualize the linear and nonlinear AE outputs</span>
<span class="n">n_plot</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_plot</span><span class="p">):</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">())</span>
  <span class="n">image</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_set</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1"># Get reconstructed image from linear autoencoder</span>
    <span class="n">lin_recon</span> <span class="o">=</span> <span class="n">lin_ae</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Get reconstruction from deep (nonlinear) autoencoder</span>
    <span class="n">nonlin_recon</span> <span class="o">=</span> <span class="n">trained_conv_AE</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Original</span><span class="se">\n</span><span class="s1">Image'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_plot</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">lin_recon</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Lin AE</span><span class="se">\n</span><span class="s1">(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_plot</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_plot</span><span class="p">)</span>
  <span class="n">plot_torch_image</span><span class="p">(</span><span class="n">nonlin_recon</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'NonLin AE</span><span class="se">\n</span><span class="s1">(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-4-variational-auto-encoders-vaes">
<h1>Section 4: Variational Auto-Encoders (VAEs)<a class="headerlink" href="#section-4-variational-auto-encoders-vaes" title="Permalink to this headline">¶</a></h1>
<p><em>Time estimate: ~25mins</em></p>
<p><strong>Please</strong> run the cell after the video to train a VAE for MNIST while watching it.</p>
<div class="section" id="video-4-variational-autoencoders">
<h2>Video 4: Variational Autoencoders<a class="headerlink" href="#video-4-variational-autoencoders" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "94124c50e94b46c8bfa7ff602e7b75ca"}
</script></div>
</div>
<p>Train a VAE for MNIST while watching the video. (Note: this VAE has a 2D latent space. If you are feeling ambitious, edit the code and modify the latent space dimensionality and see what happens.)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @markdown Train a VAE for MNIST while watching the video. (Note: this VAE has a 2D latent space. If you are feeling ambitious, edit the code and modify the latent space dimensionality and see what happens.)</span>
<span class="n">K_VAE</span> <span class="o">=</span> <span class="mi">2</span>


<span class="k">class</span> <span class="nc">ConvVAE</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Convolutional Variational Autoencoder</span>
<span class="sd">  """</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">num_filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Initialize parameters of ConvVAE</span>

<span class="sd">    Args:</span>
<span class="sd">      K: int</span>
<span class="sd">        Bottleneck dimensionality</span>
<span class="sd">      num_filters: int</span>
<span class="sd">        Number of filters [default: 32]</span>
<span class="sd">      filter_size: int</span>
<span class="sd">        Filter size [default: 5]</span>

<span class="sd">    Returns:</span>
<span class="sd">      Nothing</span>
<span class="sd">    """</span>

    <span class="nb">super</span><span class="p">(</span><span class="n">ConvVAE</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># With padding=0, the number of pixels cut off from</span>
    <span class="c1"># each image dimension</span>
    <span class="c1"># is filter_size // 2. Double it to get the amount</span>
    <span class="c1"># of pixels lost in</span>
    <span class="c1"># width and height per Conv2D layer, or added back</span>
    <span class="c1"># in per</span>
    <span class="c1"># ConvTranspose2D layer.</span>
    <span class="n">filter_reduction</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">filter_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># After passing input through two Conv2d layers,</span>
    <span class="c1"># the shape will be</span>
    <span class="c1"># 'shape_after_conv'. This is also the shape that</span>
    <span class="c1"># will go into the first</span>
    <span class="c1"># deconvolution layer in the decoder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_filters</span><span class="p">,</span>
                              <span class="n">data_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">filter_reduction</span><span class="p">,</span>
                              <span class="n">data_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">filter_reduction</span><span class="p">)</span>
    <span class="n">flat_size_after_conv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> \
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> \
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Define the recognition model (encoder or q) part</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">q_bias</span> <span class="o">=</span> <span class="n">BiasLayer</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">q_conv_1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">data_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_filters</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">q_conv_2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">num_filters</span><span class="p">,</span> <span class="n">num_filters</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">q_flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">q_fc_phi</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">flat_size_after_conv</span><span class="p">,</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Define the generative model (decoder or p) part</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_fc_upsample</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">flat_size_after_conv</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_unflatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Unflatten</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_deconv_1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="n">num_filters</span><span class="p">,</span> <span class="n">num_filters</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_deconv_2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ConvTranspose2d</span><span class="p">(</span><span class="n">num_filters</span><span class="p">,</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">p_bias</span> <span class="o">=</span> <span class="n">BiasLayer</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span>

    <span class="c1"># Define a special extra parameter to learn</span>
    <span class="c1"># scalar sig_x for all pixels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_sig_x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(()))</span>

  <span class="k">def</span> <span class="nf">infer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Map (batch of) x to (batch of) phi which</span>
<span class="sd">    can then be passed to</span>
<span class="sd">    rsample to get z</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input features</span>

<span class="sd">    Returns:</span>
<span class="sd">      phi: np.ndarray</span>
<span class="sd">        Relative entropy</span>
<span class="sd">    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_bias</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_conv_1</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_conv_2</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">flat_s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_fc_phi</span><span class="p">(</span><span class="n">flat_s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phi</span>

  <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Map [b,n,k] sized samples of z to</span>
<span class="sd">    [b,n,p] sized images</span>

<span class="sd">    Args:</span>
<span class="sd">      zs: np.ndarray</span>
<span class="sd">        Samples</span>

<span class="sd">    Returns:</span>
<span class="sd">      mu_zs: np.ndarray</span>
<span class="sd">        Mean of samples</span>
<span class="sd">    """</span>
    <span class="c1"># Note that for the purposes of passing</span>
    <span class="c1"># through the generator, we need</span>
    <span class="c1"># to reshape zs to be size [b*n,k]</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">zs</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_fc_upsample</span><span class="p">(</span><span class="n">s</span><span class="p">))</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="n">b</span><span class="o">*</span><span class="n">n</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_after_conv</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_deconv_1</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_deconv_2</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_bias</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">mu_xs</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mu_xs</span>

  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zs</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Decoder</span>

<span class="sd">    Args:</span>
<span class="sd">      zs: np.ndarray</span>
<span class="sd">        Samples</span>

<span class="sd">    Returns:</span>
<span class="sd">      Generated images</span>
<span class="sd">    """</span>
    <span class="c1"># Included for compatability with conv-AE code</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">zs</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Forward pass</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input image</span>

<span class="sd">    Returns:</span>
<span class="sd">      Generated images</span>
<span class="sd">    """</span>
    <span class="c1"># VAE.forward() is not used for training,</span>
    <span class="c1"># but we'll treat it like a</span>
    <span class="c1"># classic autoencoder by taking a single</span>
    <span class="c1"># sample of z ~ q</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">rsample</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>

  <span class="k">def</span> <span class="nf">elbo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Run input end to end through the VAE</span>
<span class="sd">    and compute the ELBO using n</span>
<span class="sd">    samples of z</span>

<span class="sd">    Args:</span>
<span class="sd">      x: torch.tensor</span>
<span class="sd">        Input image</span>
<span class="sd">      n: int</span>
<span class="sd">        Number of samples of z</span>

<span class="sd">    Returns:</span>
<span class="sd">      Difference between true and estimated KL divergence</span>
<span class="sd">    """</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">zs</span> <span class="o">=</span> <span class="n">rsample</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">mu_xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log_p_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu_xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_sig_x</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span> <span class="o">-</span> <span class="n">kl_q_p</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">expected_z</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Expected sample entropy</span>

<span class="sd">  Args:</span>
<span class="sd">    phi: list</span>
<span class="sd">      Relative entropy</span>

<span class="sd">  Returns:</span>
<span class="sd">    Expected sample entropy</span>
<span class="sd">  """</span>
  <span class="k">return</span> <span class="n">phi</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">rsample</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Sample z ~ q(z;phi)</span>
<span class="sd">  Output z is size [b,n_samples,K] given</span>
<span class="sd">  phi with shape [b,K+1]. The first K</span>
<span class="sd">  entries of each row of phi are the mean of q,</span>
<span class="sd">  and phi[:,-1] is the log</span>
<span class="sd">  standard deviation</span>

<span class="sd">  Args:</span>
<span class="sd">    phi: list</span>
<span class="sd">      Relative entropy</span>
<span class="sd">    n_samples: int</span>
<span class="sd">      Number of samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    Output z is size [b,n_samples,K] given</span>
<span class="sd">  phi with shape [b,K+1]. The first K</span>
<span class="sd">  entries of each row of phi are the mean of q,</span>
<span class="sd">  and phi[:,-1] is the log</span>
<span class="sd">  standard deviation</span>
<span class="sd">  """</span>
  <span class="n">b</span><span class="p">,</span> <span class="n">kplus1</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
  <span class="n">k</span> <span class="o">=</span> <span class="n">kplus1</span><span class="o">-</span><span class="mi">1</span>
  <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">phi</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
  <span class="n">eps</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">phi</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">eps</span><span class="o">*</span><span class="n">sig</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">mu</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">train_vae</span><span class="p">(</span><span class="n">vae</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Train VAE</span>

<span class="sd">  Args:</span>
<span class="sd">    vae: nn.module</span>
<span class="sd">      Model</span>
<span class="sd">    dataset: function</span>
<span class="sd">      Dataset</span>
<span class="sd">    epochs: int</span>
<span class="sd">      Epochs</span>
<span class="sd">    n_samples: int</span>
<span class="sd">      Number of samples</span>

<span class="sd">  Returns:</span>
<span class="sd">    elbo_vals: list</span>
<span class="sd">      List of values obtained from ELBO</span>
<span class="sd">  """</span>
  <span class="n">opt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">vae</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">elbo_vals</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">vae</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
  <span class="n">vae</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
  <span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">'Epochs'</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">im</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">//</span> <span class="mi">250</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">'Batches'</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
      <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
      <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">vae</span><span class="o">.</span><span class="n">elbo</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
      <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
      <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

      <span class="n">elbo_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="n">vae</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">'cpu'</span><span class="p">)</span>
  <span class="n">vae</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">elbo_vals</span>


<span class="n">trained_conv_VarAE</span> <span class="o">=</span> <span class="n">ConvVAE</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="n">K_VAE</span><span class="p">)</span>
<span class="n">elbo_vals</span> <span class="o">=</span> <span class="n">train_vae</span><span class="p">(</span><span class="n">trained_conv_VarAE</span><span class="p">,</span> <span class="n">train_set</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Learned sigma_x is </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">trained_conv_VarAE</span><span class="o">.</span><span class="n">log_sig_x</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="c1"># Uncomment below if you'd like to see the the training</span>
<span class="c1"># curve of the evaluated ELBO loss function</span>
<span class="c1"># ELBO is the loss function used to train VAEs</span>
<span class="c1"># (see lecture!)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elbo_vals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Batch #'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'ELBO'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "5ed31d55364f4c2d8b6a768b1326f899"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6c066d3d54e04796950fe23bf9a027e1"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "0314f95b51414cb5a215f57b2c77bd02"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "821485786af748deba2c5e51744558b6"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "ba13938eb5a8498583743532a9e26660"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "ddc1e4b3afab4da59ab1788c13a1698b"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "af05c9cd97a04d2d8d4c6f337c58fa99"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fe0e29f359cd498ca9ae24bb29e58563"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c5154f6490b24fbf95a70202e310dfb8"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b436c53ea0b949488db2ac60eb2f2867"}
</script><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b1c250f1ddba438a899698f5f2fda3cc"}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Learned sigma_x is 0.21221481263637543
</pre></div>
</div>
<img alt="../../../_images/W2D4_Tutorial1_105_12.png" src="../../../_images/W2D4_Tutorial1_105_12.png"/>
</div>
</div>
</div>
<div class="section" id="section-4-1-components-of-a-vae">
<h2>Section 4.1: Components of a VAE<a class="headerlink" href="#section-4-1-components-of-a-vae" title="Permalink to this headline">¶</a></h2>
<p><em>Recognition models and density networks</em></p>
<p>Variational AutoEncoders (VAEs) are a lot like the classic AutoEncoders (AEs), but where we explicitly think about probability distributions. In the language of VAEs, the <strong>encoder</strong> is replaced with a <strong>recognition model</strong>, and the <strong>decoder</strong> is replaced with a <strong>density network</strong>.</p>
<p>Where in a classic autoencoder the encoder maps from images to a single hidden vector,</p>
<div class="amsmath math notranslate nohighlight" id="equation-71008226-904a-420d-a341-e7a70335a7dc">
<span class="eqno">(89)<a class="headerlink" href="#equation-71008226-904a-420d-a341-e7a70335a7dc" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{x} \overset{\text{AE}}{\longrightarrow} \mathbf{h} \, ,
\end{equation}\]</div>
<p>in a VAE we would say that a recognition model maps from inputs to entire <strong>distributions</strong> over hidden vectors,</p>
<div class="amsmath math notranslate nohighlight" id="equation-5a43c551-7e61-42c7-91ad-22e0a86d0c34">
<span class="eqno">(90)<a class="headerlink" href="#equation-5a43c551-7e61-42c7-91ad-22e0a86d0c34" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{x} \overset{\text{VAE}}{\longrightarrow} q_{\mathbf{w_e}}(\mathbf{z}) \, ,
\end{equation}\]</div>
<p>which we will then sample from. Here <span class="math notranslate nohighlight">\(\mathbf{w_e}\)</span> refers to the weights of the recognition model, which parametarize our distribution generating network. We’ll say more in a moment about what kind of distribution <span class="math notranslate nohighlight">\(q_{\mathbf{w_e}}(\mathbf{z})\)</span> is.
Part of what makes VAEs work is that the loss function will require good reconstructions of the input not just for a single <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>, but <em>on average</em> from samples of <span class="math notranslate nohighlight">\(\mathbf{z} \sim q_{\mathbf{w_e}}(\mathbf{z})\)</span>.</p>
<p>In the classic autoencoder, we had a decoder which maps from hidden vectors to reconstructions of the input:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5abad64a-527a-49de-b90b-ba7a0286011a">
<span class="eqno">(91)<a class="headerlink" href="#equation-5abad64a-527a-49de-b90b-ba7a0286011a" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{h} \overset{\text{AE}}{\longrightarrow} \mathbf{x'} \, .
\end{equation}\]</div>
<p>In a density network, reconstructions are expressed in terms of a distribution:</p>
<div class="amsmath math notranslate nohighlight" id="equation-89b4a60e-46fe-40f5-b340-684627b5b003">
<span class="eqno">(92)<a class="headerlink" href="#equation-89b4a60e-46fe-40f5-b340-684627b5b003" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{z} \overset{\text{VAE}}{\longrightarrow} p_{\mathbf{w_d}}(\mathbf{x}|\mathbf{z})
\end{equation}\]</div>
<p>where, as above, <span class="math notranslate nohighlight">\(p_{\mathbf{w_d}}(\mathbf{x}|\mathbf{z})\)</span> is defined by mapping <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> through a density network then treating the resulting <span class="math notranslate nohighlight">\(f(\mathbf{z};\mathbf{w_d})\)</span> as the mean of a (Gaussian) distribution over <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. Similarly, our reconstruction distribution is parametarized by the weights of the density network.</p>
</div>
<div class="section" id="section-4-2-generating-novel-images-from-the-decoder">
<h2>Section 4.2: Generating novel images from the decoder<a class="headerlink" href="#section-4-2-generating-novel-images-from-the-decoder" title="Permalink to this headline">¶</a></h2>
<p>If we isolate the decoder part of the AutoEncoder, what we have is a neural network that takes as input a vector of size <span class="math notranslate nohighlight">\(K\)</span> and produces as output an image that looks something like our training data. Recall that in our earlier notation, we had an input <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> that was mapped to a low-dimensional hidden representation <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> which was then decoded into a reconstruction of the input, <span class="math notranslate nohighlight">\(\mathbf{x'}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f20a595e-9655-4df4-9287-7bccfb3ddf87">
<span class="eqno">(93)<a class="headerlink" href="#equation-f20a595e-9655-4df4-9287-7bccfb3ddf87" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{x} \overset{\text{encode}}{\longrightarrow} \mathbf{h} \overset{\text{decode}}{\longrightarrow} \mathbf{x'}\, .
\end{equation}\]</div>
<p>Partly as a matter of convention, and partly to distinguish where we are going next from the previous section, we’re going to introduce a new variable, <span class="math notranslate nohighlight">\(\mathbf{z} \in \mathbb{R}^K\)</span>, which will take the place of <span class="math notranslate nohighlight">\(\mathbf{h}\)</span>. The key difference is that while <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> is produced by the encoder for a particular <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> will be drawn out of thin air from a prior of our choosing:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3abfb462-0512-48aa-9457-f9b9e60ffde8">
<span class="eqno">(94)<a class="headerlink" href="#equation-3abfb462-0512-48aa-9457-f9b9e60ffde8" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\mathbf{z} \sim p(\mathbf{z})\\ \mathbf{z} \overset{\text{decode}}{\longrightarrow} \mathbf{x}\, .
\end{equation}\]</div>
<p>(Note that it is also common convention to drop the “prime” on <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> when it is no longer being thought of as a “reconstruction”).</p>
<div class="section" id="coding-exercise-4-2-generating-images">
<h3>Coding Exercise 4.2: Generating images<a class="headerlink" href="#coding-exercise-4-2-generating-images" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_images</span><span class="p">(</span><span class="n">autoencoder</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">n_images</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generate n_images 'new' images from the decoder part of the given</span>
<span class="sd">  autoencoder.</span>

<span class="sd">  Args:</span>
<span class="sd">    autoencoder: nn.module</span>
<span class="sd">      Autoencoder model</span>
<span class="sd">    K: int</span>
<span class="sd">      Bottleneck dimension</span>
<span class="sd">    n_images: int</span>
<span class="sd">      Number of images</span>

<span class="sd">  Returns:</span>
<span class="sd">    x: torch.tensor</span>
<span class="sd">      (n_images, channels, height, width) tensor of images</span>
<span class="sd">  """</span>
  <span class="c1"># Concatenate tuples to get (n_images, channels, height, width)</span>
  <span class="n">output_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_images</span><span class="p">,)</span> <span class="o">+</span> <span class="n">data_shape</span>
  <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Fill in all missing code below (...),</span>
    <span class="c1"># then remove or comment the line below to test your function</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Please complete the `generate_images` function!"</span><span class="p">)</span>
    <span class="c1">####################################################################</span>
    <span class="c1"># Sample z from a unit gaussian, pass through autoencoder.decode()</span>
    <span class="n">z</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">...</span>

    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">output_shape</span><span class="p">)</span>


<span class="c1"># Add event to airtable</span>
<span class="n">atform</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">'Coding Exercise 4.2: Generating images'</span><span class="p">)</span>

<span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>
<span class="c1">## Uncomment to test your solution</span>
<span class="c1"># images = generate_images(trained_conv_AE, K, n_images=9)</span>
<span class="c1"># plot_images(images, plt_title='Images Generated from the Conv-AE')</span>
<span class="c1"># images = generate_images(trained_conv_VarAE, K_VAE, n_images=9)</span>
<span class="c1"># plot_images(images, plt_title='Images Generated from a Conv-Variational-AE')</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Random seed 2021 has been set.
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_a92a047e.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_a92a047e_1.png"><img align="center" alt="Solution hint" class="align-center" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_a92a047e_1.png" style="width: 826.0px; height: 886.0px;"/></a>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_a92a047e_2.png"><img align="center" alt="Solution hint" class="align-center" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content-dl/main/tutorials/W2D4_GenerativeModels/static/W2D4_Tutorial1_Solution_a92a047e_2.png" style="width: 855.0px; height: 886.0px;"/></a>
</div>
<div class="section" id="think-4-2-autoencoders-vs-variational-autoencoders">
<h3>Think! 4.2: AutoEncoders vs. Variational AutoEncoders<a class="headerlink" href="#think-4-2-autoencoders-vs-variational-autoencoders" title="Permalink to this headline">¶</a></h3>
<p>Compare the images generated by the AutoEncoder to the images generated by the Variational AutoEncoder. You can run the code a few times to see a variety of examples.</p>
<p>Does one set look more like the training set (handwritten digits) than the other? What is driving this difference?</p>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content-dl/tree/main//tutorials/W2D4_GenerativeModels/solutions/W2D4_Tutorial1_Solution_f63c0e9f.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-5-state-of-the-art-vaes-and-wrap-up">
<h1>Section 5: State of the art VAEs and Wrap-up<a class="headerlink" href="#section-5-state-of-the-art-vaes-and-wrap-up" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-5-state-of-the-art-vaes">
<h2>Video 5: State-Of-The-Art VAEs<a class="headerlink" href="#video-5-state-of-the-art-vaes" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "352834ca53a04ce783991605cebe1045"}
</script></div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>Through this tutorial, we have learned</p>
<ul class="simple">
<li><p>What a generative model is and why we are interested in them.</p></li>
<li><p>How latent variable models relate to generative models with the example of pPCA.</p></li>
<li><p>What a basic AutoEncoder is and how they relate to other latent variable models.</p></li>
<li><p>The basics of Variational AutoEncoders and how they function as generative models.</p></li>
<li><p>An introduction to the broad applications of VAEs.</p></li>
</ul>
<p>In the next two tutorials we will cover GANs and how to train them.</p>
<div class="section" id="airtable-submission-link">
<h2>Airtable Submission Link<a class="headerlink" href="#airtable-submission-link" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Airtable Submission Link</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span> <span class="k">as</span> <span class="n">IPydisplay</span>
<span class="n">IPydisplay</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
   <span class="sa">f</span><span class="s2">"""</span>
<span class="s2"> &lt;div&gt;</span>
<span class="s2">   &lt;a href= "</span><span class="si">{</span><span class="n">atform</span><span class="o">.</span><span class="n">url</span><span class="p">()</span><span class="si">}</span><span class="s2">" target="_blank"&gt;</span>
<span class="s2">   &lt;img src="https://github.com/NeuromatchAcademy/course-content-dl/blob/main/tutorials/static/AirtableSubmissionButton.png?raw=1"</span>
<span class="s2"> alt="button link to Airtable" style="width:410px"&gt;&lt;/a&gt;</span>
<span class="s2">   &lt;/div&gt;"""</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>
<a href="https://portal.neuromatchacademy.org/api/redirect/to/9c55f6cb-cdf9-4429-ac1c-ec44fe64c303?data=eyJmb3JtX2lkIjogImFwcG43VmRQUnNlU29NWEVHIiwgInRhYmxlX25hbWUiOiAiVzJENV9UMSIsICJhbnN3ZXJzIjoge30sICJldmVudHMiOiBbeyJldmVudCI6ICJpbml0IiwgInRzIjogMTY1Njg0MjE1My40Nzk0MjN9LCB7ImV2ZW50IjogIlZpZGVvIDE6IEdlbmVyYXRpdmUgTW9kZWxpbmciLCAidHMiOiAxNjU2ODQyMTU5LjQ0MTQzNzd9LCB7ImV2ZW50IjogIlZpZGVvIDI6IExhdGVudCBWYXJpYWJsZSBNb2RlbHMiLCAidHMiOiAxNjU2ODQyMTYzLjU1MTkyMzh9LCB7ImV2ZW50IjogIkNvZGluZyBFeGVyY2lzZSAyOiBwUENBIiwgInRzIjogMTY1Njg0MjE2NC4wNzc4MzA2fSwgeyJldmVudCI6ICJWaWRlbyAzOiBBdXRvZW5jb25kZXJzIiwgInRzIjogMTY1Njg0MjE2NC4yMjY3NTl9LCB7ImV2ZW50IjogIkNvZGluZyBFeGVyY2lzZSAzLjE6IExpbmVhciBBdXRvRW5jb2RlciBBcmNoaXRlY3R1cmUiLCAidHMiOiAxNjU2ODQyMTcxLjAzODkwNjN9LCB7ImV2ZW50IjogIkNvZGluZyBFeGVyY2lzZSAzLjI6IEZpbGwgaW4gY29kZSBmb3IgdGhlIENvbnZBdXRvRW5jb2RlciBtb2R1bGUiLCAidHMiOiAxNjU2ODQyMjEzLjA3MjE1MjZ9LCB7ImV2ZW50IjogIlZpZGVvIDQ6IFZhcmlhdGlvbmFsIEF1dG9lbmNvZGVycyIsICJ0cyI6IDE2NTY4NDIyMTMuMjM2NDg1NX0sIHsiZXZlbnQiOiAiQ29kaW5nIEV4ZXJjaXNlIDQuMjogR2VuZXJhdGluZyBpbWFnZXMiLCAidHMiOiAxNjU2ODQzNDgyLjYxMjIxNDN9LCB7ImV2ZW50IjogIlZpZGVvIDU6IFN0YXRlLU9mLVRoZS1BcnQgVkFFcyIsICJ0cyI6IDE2NTY4NDM0ODIuNzg0OTYwNX0sIHsiZXZlbnQiOiAidXJsIGdlbmVyYXRlZCIsICJ0cyI6IDE2NTY4NDM0ODIuODAzNzcwOH1dfQ%3D%3D" target="_blank">
<img alt="button link to Airtable" src="https://github.com/NeuromatchAcademy/course-content-dl/blob/main/tutorials/static/AirtableSubmissionButton.png?raw=1" style="width:410px"/></a>
</div></div></div>
</div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"16c4e131721c4024b673fa3a8c9eb78b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fd71cd8ccb15403f9e8d421adf647be3": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_16c4e131721c4024b673fa3a8c9eb78b", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1Vy4y1j7cN\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.BiliVideo at 0x7fd8cd716490>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1Vy4y1j7cN&page=1?fs=1\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "a4c6905cbec04378865f5212dda80dc6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "163c80dc845647c087f22ebb1536fd8a": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a4c6905cbec04378865f5212dda80dc6", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=5EEx0sdyR_U\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fd8cd7161d0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/5EEx0sdyR_U?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "203c352494a4493598c77056ba15614c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c31c1fbd94424476890e883799f2d1d3": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_163c80dc845647c087f22ebb1536fd8a", "IPY_MODEL_fd71cd8ccb15403f9e8d421adf647be3"], "layout": "IPY_MODEL_203c352494a4493598c77056ba15614c", "selected_index": 0}}, "9abd097d5a2049b9a1562647b643158c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "440px"}}, "6350a103281c4e84b675b12483b660c1": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "cef84a7085ac4e249000a6a10587b23b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": false, "description": "Z Magnitude", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_9abd097d5a2049b9a1562647b643158c", "max": 15, "min": -15, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6350a103281c4e84b675b12483b660c1", "value": 0}}, "3d856729c4d84a38a8b6c8b49d07090b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ee69302c3b054d7c9b7d2416162935c0": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "b1f1a097f16e475eafe68c5966f54299": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["tench", "magpie", "jellyfish", "German shepherd", "bee", "acoustic guitar", "coffee mug", "minibus", "monitor"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Category: ", "description_tooltip": null, "disabled": false, "index": 3, "layout": "IPY_MODEL_3d856729c4d84a38a8b6c8b49d07090b", "style": "IPY_MODEL_ee69302c3b054d7c9b7d2416162935c0"}}, "ea3bffd495284b5ab40ea864385db011": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8341caf8454341b6a793e8ebdf56bc30": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b1f1a097f16e475eafe68c5966f54299", "IPY_MODEL_cef84a7085ac4e249000a6a10587b23b"], "layout": "IPY_MODEL_ea3bffd495284b5ab40ea864385db011"}}, "274b80ec13514d4ca47fcdd173433c7b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "036f350cee9f47f4a2e3335076098008": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_274b80ec13514d4ca47fcdd173433c7b", "msg_id": "", "outputs": [{"output_type": "error", "ename": "ImportError", "evalue": "You need to install nltk to use this function", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/pytorch_pretrained_biggan/utils.py\u001b[0m in \u001b[0;36mone_hot_from_names\u001b[0;34m(class_name_or_list, batch_size)\u001b[0m\n\u001b[1;32m    184\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 185\u001b[0;31m         \u001b[0;32mfrom\u001b[0m \u001b[0mnltk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcorpus\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mwordnet\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mwn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    186\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'nltk'", "\nDuring handling of the above exception, another exception occurred:\n", "\u001b[0;31mImportError\u001b[0m                               Traceback (most recent call last)", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/ipywidgets/widgets/interaction.py\u001b[0m in \u001b[0;36mobserver\u001b[0;34m(change)\u001b[0m\n\u001b[1;32m     78\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mout\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     79\u001b[0m             \u001b[0mclear_output\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 80\u001b[0;31m             \u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     81\u001b[0m             \u001b[0mshow_inline_matplotlib_plots\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     82\u001b[0m     \u001b[0;32mfor\u001b[0m \u001b[0mk\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mw\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcontrols\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m/tmp/ipykernel_45149/574137483.py\u001b[0m in \u001b[0;36msample_from_biggan\u001b[0;34m(category, z_magnitude)\u001b[0m\n\u001b[1;32m     19\u001b[0m   \u001b[0munit_vector\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mones\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m128\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msqrt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m128\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     20\u001b[0m   \u001b[0mz\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mz_magnitude\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0munit_vector\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 21\u001b[0;31m   \u001b[0my\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mone_hot_from_names\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcategory\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     22\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     23\u001b[0m   \u001b[0mz\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_numpy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mz\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/pytorch_pretrained_biggan/utils.py\u001b[0m in \u001b[0;36mone_hot_from_names\u001b[0;34m(class_name_or_list, batch_size)\u001b[0m\n\u001b[1;32m    185\u001b[0m         \u001b[0;32mfrom\u001b[0m \u001b[0mnltk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcorpus\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mwordnet\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mwn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 187\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"You need to install nltk to use this function\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    188\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mclass_name_or_list\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mlist\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtuple\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;31mImportError\u001b[0m: You need to install nltk to use this function"]}]}}, "0041d84584fa46fc9178f7be66acf53c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8a5f8a88b79649129bdd4652429c5bc3": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "fa87d285ad104fccab1bcd5aac968a49": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0041d84584fa46fc9178f7be66acf53c", "placeholder": "Type something", "rows": null, "style": "IPY_MODEL_8a5f8a88b79649129bdd4652429c5bc3", "value": "Type your answer here and click on `Submit!`"}}, "f012fa7a3aa94bb2a8f0d82ddd06a948": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5140ad2a32ac41f1b821d65396ff44ea": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "eb80e48e0dd942fead85fa28f36b953d": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit!", "disabled": false, "icon": "", "layout": "IPY_MODEL_f012fa7a3aa94bb2a8f0d82ddd06a948", "style": "IPY_MODEL_5140ad2a32ac41f1b821d65396ff44ea", "tooltip": ""}}, "b9c47e0482d141399ce664e91b8cff45": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "440px"}}, "671615b77136465ea5b1369884e118b1": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "initial", "handle_color": null}}, "ec08a553254c47f1aa51268f64aaa6d0": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": false, "description": "Z Magnitude A", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b9c47e0482d141399ce664e91b8cff45", "max": 10, "min": -10, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_671615b77136465ea5b1369884e118b1", "value": 0}}, "0bcc154cb52a4fdc85dc91286bb02599": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "440px"}}, "c20c3d6be0fd4de4baede88ceab8480a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "initial", "handle_color": null}}, "35b6e56fc7b74e7482e17e49612b73d7": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": false, "description": "Z Magntude B", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0bcc154cb52a4fdc85dc91286bb02599", "max": 10, "min": -10, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_c20c3d6be0fd4de4baede88ceab8480a", "value": 0}}, "b648fb859b4a4ef0b4efcfae732cf5d0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4b8002c5473c48539eedbe1183709580": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2f926ebd7d9f476ba35a4d696c8dfb4e": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["tench", "magpie", "jellyfish", "German shepherd", "bee", "acoustic guitar", "coffee mug", "minibus", "monitor"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Category A: ", "description_tooltip": null, "disabled": false, "index": 3, "layout": "IPY_MODEL_b648fb859b4a4ef0b4efcfae732cf5d0", "style": "IPY_MODEL_4b8002c5473c48539eedbe1183709580"}}, "ef846d89dcfd46a5b2cc97f7044fa4d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9fc438f59fe345738842e9d8d6555201": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "c028501ff8944ed2a22cb3f207fa8749": {"model_name": "DropdownModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DropdownModel", "_options_labels": ["tench", "magpie", "jellyfish", "German shepherd", "bee", "acoustic guitar", "coffee mug", "minibus", "monitor"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "DropdownView", "description": "Category B: ", "description_tooltip": null, "disabled": false, "index": 2, "layout": "IPY_MODEL_ef846d89dcfd46a5b2cc97f7044fa4d4", "style": "IPY_MODEL_9fc438f59fe345738842e9d8d6555201"}}, "32962ffdc4564731b948462ab735aa02": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02432a55fd3f4e1bb62b0dbb1d41c1fa": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_2f926ebd7d9f476ba35a4d696c8dfb4e", "IPY_MODEL_ec08a553254c47f1aa51268f64aaa6d0"], "layout": "IPY_MODEL_32962ffdc4564731b948462ab735aa02"}}, "87ed439baa714fcfb6ced98aba391dbf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c460e1aef1794a7ba3d3aced4b100f7d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c028501ff8944ed2a22cb3f207fa8749", "IPY_MODEL_35b6e56fc7b74e7482e17e49612b73d7"], "layout": "IPY_MODEL_87ed439baa714fcfb6ced98aba391dbf"}}, "1a25d3c92e5b47b69e543f9d7dfbb4c6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e355fed0f2e642e3963d4e52addba4da": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_02432a55fd3f4e1bb62b0dbb1d41c1fa", "IPY_MODEL_c460e1aef1794a7ba3d3aced4b100f7d"], "layout": "IPY_MODEL_1a25d3c92e5b47b69e543f9d7dfbb4c6"}}, "4ae9594627844ea6997bc0fd72581afd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7675de7d6f26437190b512ac3a7b0480": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_4ae9594627844ea6997bc0fd72581afd", "msg_id": "", "outputs": [{"output_type": "error", "ename": "ImportError", "evalue": "You need to install nltk to use this function", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/pytorch_pretrained_biggan/utils.py\u001b[0m in \u001b[0;36mone_hot_from_names\u001b[0;34m(class_name_or_list, batch_size)\u001b[0m\n\u001b[1;32m    184\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 185\u001b[0;31m         \u001b[0;32mfrom\u001b[0m \u001b[0mnltk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcorpus\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mwordnet\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mwn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    186\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'nltk'", "\nDuring handling of the above exception, another exception occurred:\n", "\u001b[0;31mImportError\u001b[0m                               Traceback (most recent call last)", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/ipywidgets/widgets/interaction.py\u001b[0m in \u001b[0;36mobserver\u001b[0;34m(change)\u001b[0m\n\u001b[1;32m     78\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mout\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     79\u001b[0m             \u001b[0mclear_output\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mwait\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 80\u001b[0;31m             \u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     81\u001b[0m             \u001b[0mshow_inline_matplotlib_plots\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     82\u001b[0m     \u001b[0;32mfor\u001b[0m \u001b[0mk\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mw\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcontrols\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitems\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m/tmp/ipykernel_45149/2903687455.py\u001b[0m in \u001b[0;36minterpolate_biggan\u001b[0;34m(category_A, z_magnitude_A, category_B, z_magnitude_B)\u001b[0m\n\u001b[1;32m     52\u001b[0m   \u001b[0mz_A\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mz_magnitude_A\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0munit_vector\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     53\u001b[0m   \u001b[0mz_B\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mz_magnitude_B\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0munit_vector\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 54\u001b[0;31m   \u001b[0my_A\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mone_hot_from_names\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcategory_A\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     55\u001b[0m   \u001b[0my_B\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mone_hot_from_names\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcategory_B\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     56\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.13/x64/lib/python3.7/site-packages/pytorch_pretrained_biggan/utils.py\u001b[0m in \u001b[0;36mone_hot_from_names\u001b[0;34m(class_name_or_list, batch_size)\u001b[0m\n\u001b[1;32m    185\u001b[0m         \u001b[0;32mfrom\u001b[0m \u001b[0mnltk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcorpus\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mwordnet\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mwn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    186\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 187\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mImportError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"You need to install nltk to use this function\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    188\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mclass_name_or_list\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mlist\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtuple\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;31mImportError\u001b[0m: You need to install nltk to use this function"]}]}}, "c213aefe8b904b469c3817385f5a383f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0637a5c6bff54219943cebc56f41c307": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "6ecffedca16f4ff7ad91ac2f86ff5582": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_c213aefe8b904b469c3817385f5a383f", "placeholder": "Type something", "rows": null, "style": "IPY_MODEL_0637a5c6bff54219943cebc56f41c307", "value": "Type your answer here and click on `Submit!`"}}, "95263ca00084472d938251df6f045f40": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "abf25281ca87482c965ddd7264811bba": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "00485dcce031495c93a15ba11b1ee3e9": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit!", "disabled": false, "icon": "", "layout": "IPY_MODEL_95263ca00084472d938251df6f045f40", "style": "IPY_MODEL_abf25281ca87482c965ddd7264811bba", "tooltip": ""}}, "13a54c51b4f842278007880cdb030a68": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9118766a469d48ef9dfd15c6c722709f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_13a54c51b4f842278007880cdb030a68", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1Db4y167Ys\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.BiliVideo at 0x7fd8cb49fbd0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1Db4y167Ys&page=1?fs=1\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "fc64f175f4b24f53abbc6ec548397d53": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2500627e144a4e0a94a355287fa3a1ad": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_fc64f175f4b24f53abbc6ec548397d53", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=_e0nKUeBDFo\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fd8cb4a7a90>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/_e0nKUeBDFo?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "1d1d0ff2c84748cdb7d5828ab5d8d585": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b3ba09c8e80842c99a35b9256a954dfb": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_2500627e144a4e0a94a355287fa3a1ad", "IPY_MODEL_9118766a469d48ef9dfd15c6c722709f"], "layout": "IPY_MODEL_1d1d0ff2c84748cdb7d5828ab5d8d585", "selected_index": 0}}, "9da270d3e260421da69e645c1dff214f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3078461e50e34880b878947171d7d7af": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9da270d3e260421da69e645c1dff214f", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV16b4y167Z2\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.BiliVideo at 0x7fd8cd6a93d0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV16b4y167Z2&page=1?fs=1\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "d375d763a3414dfdafd372fff80290a3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "311c21a68d7d41218f14852d94f8a83b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d375d763a3414dfdafd372fff80290a3", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=MlyIL1PmDCA\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fd8cb583590>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/MlyIL1PmDCA?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "f6539eee45e9417eb3aca577589d6fb8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dda05adb2c2b4bb6a215e70c56bc0cb1": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_311c21a68d7d41218f14852d94f8a83b", "IPY_MODEL_3078461e50e34880b878947171d7d7af"], "layout": "IPY_MODEL_f6539eee45e9417eb3aca577589d6fb8", "selected_index": 0}}, "c77556437e7c4e28a3b5c74c42276976": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8393b08f644442868f61413f88cf57b7": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "795c9f1ef3c542f99f18be52511c3de6": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c77556437e7c4e28a3b5c74c42276976", "max": 1875.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_8393b08f644442868f61413f88cf57b7", "value": 1875.0}}, "5964414d379f4260a5f35dcbdd50bb9c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a856fe6e2e694bf8b59f85f3f5a3373a": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "57b3c2642b0a43a8b23e032c9cb24bd4": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5964414d379f4260a5f35dcbdd50bb9c", "placeholder": "\u200b", "style": "IPY_MODEL_a856fe6e2e694bf8b59f85f3f5a3373a", "value": "Computing pixel mean and covariance...: 100%"}}, "224384aebc1547a78ff550ef507024b9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "adbb7d5cc1d04e02afbafd0f7d9645a1": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "efd6bafc2ee14dfa96a7e8c3555d78c4": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_224384aebc1547a78ff550ef507024b9", "placeholder": "\u200b", "style": "IPY_MODEL_adbb7d5cc1d04e02afbafd0f7d9645a1", "value": " 1872/1875 [00:41&lt;00:00, 46.24it/s]"}}, "1be5bb7bd70b4ab89991ae79bed20fdd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1d9b9c8edfbf49109785188b69db3515": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_57b3c2642b0a43a8b23e032c9cb24bd4", "IPY_MODEL_795c9f1ef3c542f99f18be52511c3de6", "IPY_MODEL_efd6bafc2ee14dfa96a7e8c3555d78c4"], "layout": "IPY_MODEL_1be5bb7bd70b4ab89991ae79bed20fdd"}}, "e5568bd0d34744558a32923c099b42fa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "17cf20f749f844c2a27dc09fefeb386f": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "d956b5b6e894434b978dd09ac3158e23": {"model_name": "TextareaModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TextareaModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TextareaView", "continuous_update": true, "description": "", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e5568bd0d34744558a32923c099b42fa", "placeholder": "Type something", "rows": null, "style": "IPY_MODEL_17cf20f749f844c2a27dc09fefeb386f", "value": "Type your answer here and click on `Submit!`"}}, "cad36924ac7846a592d7dafce829245f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4855e265288b4d28b9bca0ef7317f291": {"model_name": "ButtonStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "button_color": null, "font_weight": ""}}, "797462a3465c4275a6aceb09410a8a51": {"model_name": "ButtonModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ButtonView", "button_style": "", "description": "Submit!", "disabled": false, "icon": "", "layout": "IPY_MODEL_cad36924ac7846a592d7dafce829245f", "style": "IPY_MODEL_4855e265288b4d28b9bca0ef7317f291", "tooltip": ""}}, "1369345c1a204ea0a839b1a6d20ccca2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d326417b33f04dfcba4a7465f78483b5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1369345c1a204ea0a839b1a6d20ccca2", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV17v411E7ye\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.BiliVideo at 0x7fd8cd5fe2d0>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV17v411E7ye&page=1?fs=1\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "9970ba0735144ed5a775504ce5bcafbd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c2293974741b4e0696fcd9fc81356750": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9970ba0735144ed5a775504ce5bcafbd", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=srWb_Gp6OGA\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fd8cd5feb10>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/srWb_Gp6OGA?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "aae05341652c42889e83c45c8d8bdeed": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "94124c50e94b46c8bfa7ff602e7b75ca": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_c2293974741b4e0696fcd9fc81356750", "IPY_MODEL_d326417b33f04dfcba4a7465f78483b5"], "layout": "IPY_MODEL_aae05341652c42889e83c45c8d8bdeed", "selected_index": 0}}, "a267635743af44bd8ec6b3ffe914a4f1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c60bc7170ae544878dc044105fad08dd": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "367aa57e25464822bc773923933e39f9": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_a267635743af44bd8ec6b3ffe914a4f1", "max": 10.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_c60bc7170ae544878dc044105fad08dd", "value": 10.0}}, "ff8b7dfab86d49579beba8078d6a7684": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cecfe428a5334b5582cf4ead142a3f25": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "cc80e79a3eed410681d97956b35d3d28": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ff8b7dfab86d49579beba8078d6a7684", "placeholder": "\u200b", "style": "IPY_MODEL_cecfe428a5334b5582cf4ead142a3f25", "value": "Epochs: 100%"}}, "3c5e8184d289490f8105baab2413a16e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fbef9ee69cc843dfbce6a564331563d7": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "f82f048bc7c44ce0b046890954f50f4a": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_3c5e8184d289490f8105baab2413a16e", "placeholder": "\u200b", "style": "IPY_MODEL_fbef9ee69cc843dfbce6a564331563d7", "value": " 10/10 [21:09&lt;00:00, 127.17s/it]"}}, "d6a12fffba3b43bb927eb6fcbf1d7ff4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5ed31d55364f4c2d8b6a768b1326f899": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_cc80e79a3eed410681d97956b35d3d28", "IPY_MODEL_367aa57e25464822bc773923933e39f9", "IPY_MODEL_f82f048bc7c44ce0b046890954f50f4a"], "layout": "IPY_MODEL_d6a12fffba3b43bb927eb6fcbf1d7ff4"}}, "89bfad5119354a58862da7bb49ea0eaa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "22fc44be10fa4127824fc96e24abd87c": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "85dcf73896a84d32b8e089604ea92652": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_89bfad5119354a58862da7bb49ea0eaa", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_22fc44be10fa4127824fc96e24abd87c", "value": 240.0}}, "c71e34886cbb465b85974dcf3d8a5cee": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e6c51161d62548b7b749ad0e2f499118": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "1f72685f8afe4f41aa5f0643b9ea0715": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c71e34886cbb465b85974dcf3d8a5cee", "placeholder": "\u200b", "style": "IPY_MODEL_e6c51161d62548b7b749ad0e2f499118", "value": "Batches: 100%"}}, "5a1897a44d1643feb0af02be6cbd5f29": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0aed00e5cd184bb4ab345540f07fcbc1": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "414998e48cc64878a0ca917fbca24760": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5a1897a44d1643feb0af02be6cbd5f29", "placeholder": "\u200b", "style": "IPY_MODEL_0aed00e5cd184bb4ab345540f07fcbc1", "value": " 240/240 [02:05&lt;00:00,  1.91it/s]"}}, "0b29902eb5e84bddaf7ef978df859aaa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6c066d3d54e04796950fe23bf9a027e1": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1f72685f8afe4f41aa5f0643b9ea0715", "IPY_MODEL_85dcf73896a84d32b8e089604ea92652", "IPY_MODEL_414998e48cc64878a0ca917fbca24760"], "layout": "IPY_MODEL_0b29902eb5e84bddaf7ef978df859aaa"}}, "923d07d9a00440f085ad6666d026ace4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b592d50d986d4d5da3c7aad05f039455": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "e6751a8ced6b48e5a667071217aea108": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_923d07d9a00440f085ad6666d026ace4", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_b592d50d986d4d5da3c7aad05f039455", "value": 240.0}}, "c144a434f35342f580a8a16477550080": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6afa8b87fdf944f7ae9e0da82fc9466d": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "492bc151aef14186a1b421b469d01fb6": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c144a434f35342f580a8a16477550080", "placeholder": "\u200b", "style": "IPY_MODEL_6afa8b87fdf944f7ae9e0da82fc9466d", "value": "Batches: 100%"}}, "d1eca29587394268b09673af830cddb0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5d50a1651a094ca286f8cbff75fc8067": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ce8628912f9c44ad86875d6432b6d816": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_d1eca29587394268b09673af830cddb0", "placeholder": "\u200b", "style": "IPY_MODEL_5d50a1651a094ca286f8cbff75fc8067", "value": " 240/240 [02:05&lt;00:00,  1.89it/s]"}}, "3d77cde8ff7a4069bea356218a138516": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0314f95b51414cb5a215f57b2c77bd02": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_492bc151aef14186a1b421b469d01fb6", "IPY_MODEL_e6751a8ced6b48e5a667071217aea108", "IPY_MODEL_ce8628912f9c44ad86875d6432b6d816"], "layout": "IPY_MODEL_3d77cde8ff7a4069bea356218a138516"}}, "ecaf5a8749164b1fabdb30fcf16267ca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bb00a2f1603340c79fdb422207559144": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "49587f68b3f24d88b5fc7eb444a4ade1": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ecaf5a8749164b1fabdb30fcf16267ca", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_bb00a2f1603340c79fdb422207559144", "value": 240.0}}, "72677c34a67241868c27cd2c82c05561": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a4595a9abca94f4287ae290f796db6b3": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "7a2f0f3322864e37803a4642bb6474ff": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_72677c34a67241868c27cd2c82c05561", "placeholder": "\u200b", "style": "IPY_MODEL_a4595a9abca94f4287ae290f796db6b3", "value": "Batches: 100%"}}, "ec1599dc9c8c44f3b36d07290560dd99": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "edc8ceca14a5477fbae00ab891893708": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "b3de42fbb908497a9aa646cfe0c51caf": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ec1599dc9c8c44f3b36d07290560dd99", "placeholder": "\u200b", "style": "IPY_MODEL_edc8ceca14a5477fbae00ab891893708", "value": " 240/240 [02:06&lt;00:00,  1.88it/s]"}}, "338e55ddd76f40b7873e45be54a7c2f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "821485786af748deba2c5e51744558b6": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_7a2f0f3322864e37803a4642bb6474ff", "IPY_MODEL_49587f68b3f24d88b5fc7eb444a4ade1", "IPY_MODEL_b3de42fbb908497a9aa646cfe0c51caf"], "layout": "IPY_MODEL_338e55ddd76f40b7873e45be54a7c2f9"}}, "a87a9c3336e54852ab77e0bd59dd18b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8c6925c8d01e40c98f2746f10b72e380": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "51acba8583574e6ba10278e2f619b3a1": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_a87a9c3336e54852ab77e0bd59dd18b5", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_8c6925c8d01e40c98f2746f10b72e380", "value": 240.0}}, "d808ec2b1a9142b4b6515ad14870346c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e52ef14e968c4d4b83eaf25c24c12392": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "5843b5cf205443d595b02ead39848305": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_d808ec2b1a9142b4b6515ad14870346c", "placeholder": "\u200b", "style": "IPY_MODEL_e52ef14e968c4d4b83eaf25c24c12392", "value": "Batches: 100%"}}, "9304da53f1d44a8eb950941f31144443": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ee6a5c94ff194f3c8260104a1441afb2": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "45a9cc014cfa4e30b04906601c044104": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_9304da53f1d44a8eb950941f31144443", "placeholder": "\u200b", "style": "IPY_MODEL_ee6a5c94ff194f3c8260104a1441afb2", "value": " 240/240 [02:06&lt;00:00,  1.89it/s]"}}, "3681fbd62e0e4f44ac86b890d3b670b5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ba13938eb5a8498583743532a9e26660": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5843b5cf205443d595b02ead39848305", "IPY_MODEL_51acba8583574e6ba10278e2f619b3a1", "IPY_MODEL_45a9cc014cfa4e30b04906601c044104"], "layout": "IPY_MODEL_3681fbd62e0e4f44ac86b890d3b670b5"}}, "8dfbe6d5b843486db71873282c6db4e5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d4af1c46f824aa7aad4ef60df1f1f2e": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "db3f333b09af4d138045686e3aa86cde": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8dfbe6d5b843486db71873282c6db4e5", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_8d4af1c46f824aa7aad4ef60df1f1f2e", "value": 240.0}}, "3458c1ef714745759b190df1aad907d1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6c227b2fe2794efd9688ea6b7ff0a47d": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2662ab1ef4d94c9ea45280d0a46e349d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_3458c1ef714745759b190df1aad907d1", "placeholder": "\u200b", "style": "IPY_MODEL_6c227b2fe2794efd9688ea6b7ff0a47d", "value": "Batches: 100%"}}, "092d58f916dd40f2a9abdcf14df70fb2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c04f802e7257430c9534287febce57a5": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "dbf54cb05d704bf381b9de5f33183a07": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_092d58f916dd40f2a9abdcf14df70fb2", "placeholder": "\u200b", "style": "IPY_MODEL_c04f802e7257430c9534287febce57a5", "value": " 240/240 [02:06&lt;00:00,  1.92it/s]"}}, "f7d39380a27a4bd1967c79ef61c77a71": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ddc1e4b3afab4da59ab1788c13a1698b": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_2662ab1ef4d94c9ea45280d0a46e349d", "IPY_MODEL_db3f333b09af4d138045686e3aa86cde", "IPY_MODEL_dbf54cb05d704bf381b9de5f33183a07"], "layout": "IPY_MODEL_f7d39380a27a4bd1967c79ef61c77a71"}}, "88957342dfc3472dbd977351892d9d57": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "575c17fc01a24392b2c35fe070f8ab7c": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "58cb0edd0db242008f96453297f0dc65": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_88957342dfc3472dbd977351892d9d57", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_575c17fc01a24392b2c35fe070f8ab7c", "value": 240.0}}, "402729d0dcbc490c9905472c8cfd31ea": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6eb12f39362a43429a5d67d00bf1bcfa": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "69e54c5448ff4c2a8234e1b52f982c24": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_402729d0dcbc490c9905472c8cfd31ea", "placeholder": "\u200b", "style": "IPY_MODEL_6eb12f39362a43429a5d67d00bf1bcfa", "value": "Batches: 100%"}}, "4473092591f346bfb830584d81eb2e4c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "faf4fe7712aa41e6bbc57218751a170a": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ec9b2e6630e34a04b4987f3ba44fa83e": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_4473092591f346bfb830584d81eb2e4c", "placeholder": "\u200b", "style": "IPY_MODEL_faf4fe7712aa41e6bbc57218751a170a", "value": " 240/240 [02:06&lt;00:00,  1.87it/s]"}}, "3b1728ff1ad04c91a9b8ad55ea9241cd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "af05c9cd97a04d2d8d4c6f337c58fa99": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_69e54c5448ff4c2a8234e1b52f982c24", "IPY_MODEL_58cb0edd0db242008f96453297f0dc65", "IPY_MODEL_ec9b2e6630e34a04b4987f3ba44fa83e"], "layout": "IPY_MODEL_3b1728ff1ad04c91a9b8ad55ea9241cd"}}, "4fa1731a4b534223abe2f529d7f4cb08": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f2ddcd16a6b14dc1a62d99b8d6c391ea": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "68e2b2db41da4dae92172e0f70411bca": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_4fa1731a4b534223abe2f529d7f4cb08", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_f2ddcd16a6b14dc1a62d99b8d6c391ea", "value": 240.0}}, "8fcb198be75a4a8985fafae09cd908df": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "989b73a822de495d8d59567347d54865": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bd2222607c2447d9a5a8e8f261b7ad5f": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_8fcb198be75a4a8985fafae09cd908df", "placeholder": "\u200b", "style": "IPY_MODEL_989b73a822de495d8d59567347d54865", "value": "Batches: 100%"}}, "fb77e77faf144e1ba1bad795508bde9c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e68a30d644454c7fbf1789831156d3b9": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "985d2b0f0eb14cfd9299f4b87fde2411": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_fb77e77faf144e1ba1bad795508bde9c", "placeholder": "\u200b", "style": "IPY_MODEL_e68a30d644454c7fbf1789831156d3b9", "value": " 240/240 [02:08&lt;00:00,  1.88it/s]"}}, "7a0f941106514ca6b2a61f5f7441e6cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fe0e29f359cd498ca9ae24bb29e58563": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_bd2222607c2447d9a5a8e8f261b7ad5f", "IPY_MODEL_68e2b2db41da4dae92172e0f70411bca", "IPY_MODEL_985d2b0f0eb14cfd9299f4b87fde2411"], "layout": "IPY_MODEL_7a0f941106514ca6b2a61f5f7441e6cf"}}, "c649a7cefc39457faa29d654c5372c4c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02a4fd04102f49bc9a68219a199ba36b": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "94cfaf2420544ccfa9d12b8746b97547": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_c649a7cefc39457faa29d654c5372c4c", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_02a4fd04102f49bc9a68219a199ba36b", "value": 240.0}}, "255a87706f604b4fb2b6169a1e19b6af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a6e61da4710a4b5ba124620578ab7a56": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "2c861ec97d724becac338201f5e6e291": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_255a87706f604b4fb2b6169a1e19b6af", "placeholder": "\u200b", "style": "IPY_MODEL_a6e61da4710a4b5ba124620578ab7a56", "value": "Batches: 100%"}}, "70f74d9c7136485d86ddfd89437622b2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2a219060496a4a37ad4c73c0a65017e0": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "3923eab38ad54f8ba3410025ec000358": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_70f74d9c7136485d86ddfd89437622b2", "placeholder": "\u200b", "style": "IPY_MODEL_2a219060496a4a37ad4c73c0a65017e0", "value": " 240/240 [02:08&lt;00:00,  1.86it/s]"}}, "3900a2ee289c471cb3430b75019a39f4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5154f6490b24fbf95a70202e310dfb8": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_2c861ec97d724becac338201f5e6e291", "IPY_MODEL_94cfaf2420544ccfa9d12b8746b97547", "IPY_MODEL_3923eab38ad54f8ba3410025ec000358"], "layout": "IPY_MODEL_3900a2ee289c471cb3430b75019a39f4"}}, "1bde450d39b744f6aad6b976fa60bc24": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f8771441364644ae935663f42f91f313": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c9b1e4990303421fa023f4b598c8fcd6": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_1bde450d39b744f6aad6b976fa60bc24", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_f8771441364644ae935663f42f91f313", "value": 240.0}}, "58240bdfac304af0aa68b00824281c0f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "369b6aa50a6549c1a45e0b3fcc3e56a0": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "9ef4c0008a9c4e1689cc7ae9ced26014": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_58240bdfac304af0aa68b00824281c0f", "placeholder": "\u200b", "style": "IPY_MODEL_369b6aa50a6549c1a45e0b3fcc3e56a0", "value": "Batches: 100%"}}, "82c2082ef46c4fb183e38ce0099b4178": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b6ca891bc1c94868b73f3948dd672b1e": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "925a273a98904dda891bba4f6e01619c": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_82c2082ef46c4fb183e38ce0099b4178", "placeholder": "\u200b", "style": "IPY_MODEL_b6ca891bc1c94868b73f3948dd672b1e", "value": " 240/240 [02:07&lt;00:00,  1.89it/s]"}}, "3534b82ae1b843229e9b310354029f81": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b436c53ea0b949488db2ac60eb2f2867": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9ef4c0008a9c4e1689cc7ae9ced26014", "IPY_MODEL_c9b1e4990303421fa023f4b598c8fcd6", "IPY_MODEL_925a273a98904dda891bba4f6e01619c"], "layout": "IPY_MODEL_3534b82ae1b843229e9b310354029f81"}}, "3a7b8b47c9fc4010b0956da0538f7670": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "44167146549343b396286022069aabec": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "84a9dd44d6374151ad6045744a907fee": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_3a7b8b47c9fc4010b0956da0538f7670", "max": 240.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_44167146549343b396286022069aabec", "value": 240.0}}, "0c88db1fe5e745029b108ed5a4e410fb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "54f4fd2fed5d4e12b51ac8b97d99185f": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "19ad0e11be13453cb166fc64f487a616": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_0c88db1fe5e745029b108ed5a4e410fb", "placeholder": "\u200b", "style": "IPY_MODEL_54f4fd2fed5d4e12b51ac8b97d99185f", "value": "Batches: 100%"}}, "9b4fdc0f7f54491496c1a7ec792e56b7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "67e704d1fd0048079685e09aef141108": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "b2015f77e9d447758c2e08049ddbb71b": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_9b4fdc0f7f54491496c1a7ec792e56b7", "placeholder": "\u200b", "style": "IPY_MODEL_67e704d1fd0048079685e09aef141108", "value": " 240/240 [02:06&lt;00:00,  1.94it/s]"}}, "6e4293a79c204de1b0dc7ddf1c01c0f8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1c250f1ddba438a899698f5f2fda3cc": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_19ad0e11be13453cb166fc64f487a616", "IPY_MODEL_84a9dd44d6374151ad6045744a907fee", "IPY_MODEL_b2015f77e9d447758c2e08049ddbb71b"], "layout": "IPY_MODEL_6e4293a79c204de1b0dc7ddf1c01c0f8"}}, "a289b38bf9fa4a0e8c335c23645e00ea": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "114612985e434f80aeb083e2b9155ab0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a289b38bf9fa4a0e8c335c23645e00ea", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://www.bilibili.com/video/BV1hg411M7KY\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<__main__.BiliVideo at 0x7fd8cb4c2690>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://player.bilibili.com/player.html?bvid=BV1hg411M7KY&page=1?fs=1\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        "}}]}}, "06bc24a527674d198d726f6b0b715178": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6c93fd56803849d7aa41e795cc108114": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_06bc24a527674d198d726f6b0b715178", "msg_id": "", "outputs": [{"output_type": "stream", "name": "stdout", "text": "Video available at https://youtube.com/watch?v=PXBl3KwRfh4\n"}, {"output_type": "display_data", "metadata": {}, "data": {"text/plain": "<IPython.lib.display.YouTubeVideo at 0x7fd8cb56d310>", "text/html": "\n        <iframe\n            width=\"730\"\n            height=\"410\"\n            src=\"https://www.youtube.com/embed/PXBl3KwRfh4?fs=1&rel=0\"\n            frameborder=\"0\"\n            allowfullscreen\n            \n        ></iframe>\n        ", "image/jpeg": "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\n"}}]}}, "51478a3c4b0746cd95fcb8f83b9b40c8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "352834ca53a04ce783991605cebe1045": {"model_name": "TabModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "TabModel", "_titles": {"0": "Youtube", "1": "Bilibili"}, "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "TabView", "box_style": "", "children": ["IPY_MODEL_6c93fd56803849d7aa41e795cc108114", "IPY_MODEL_114612985e434f80aeb083e2b9155ab0"], "layout": "IPY_MODEL_51478a3c4b0746cd95fcb8f83b9b40c8", "selected_index": 0}}}, "version_major": 2, "version_minor": 0}
</script>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D4_GenerativeModels/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="../chapter_title.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Generative Models</p>
</div>
</a>
<a class="right-next" href="W2D4_Tutorial2.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Tutorial 2: Introduction to GANs</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Neuromatch<br>
  
      © Copyright 2021.<br/>
</br></p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>